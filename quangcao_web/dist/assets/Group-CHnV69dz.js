import{J as it,H as at,r as h,K as ze,j as r,S as te,O as ne,X as qe,T as V,bx as Jt,ag as he,F as Ps,L as Tt,by as Zt,bz as Ds,bA as es,bB as It,bC as Fs,V as xe,M as $s,Y as ge,Z as Vs,G as ue,ae as Et,a6 as ts,Q as le,bD as Us,bE as ot,bF as zs,ac as Ke,a9 as Pt,bG as qs,aj as Hs,a2 as W,a5 as T,bH as Ws,a as we,a8 as Ue,s as gt,m as ss,bI as Ys,bJ as Ks,bK as wt,bL as Xs,bM as Qs,bN as Gs,bO as Js,bP as Zs,bQ as en,o as tn}from"./index-C3f_Z7mG.js";import{u as ns,S as sn,T as nn,U as on}from"./useUpdateButtonTask-DDgipCxk.js";import{e as rn,g as an,v as cn,P as os,I as Dt,T as ln,c as Ft,a as rs,b as is,D as as,B as rt}from"./Tabs-Dw-7q5Z9.js";import{D as hn,Q as $t}from"./QRCode-D5WuQovP.js";function un(t){return it("MuiDialogContentText",t)}at("MuiDialogContentText",["root"]);const pn=t=>{const{classes:e}=t,n=qe({root:["root"]},un,e);return{...e,...n}},dn=te(V,{shouldForwardProp:t=>Jt(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),cs=h.forwardRef(function(e,s){const n=ze({props:e,name:"MuiDialogContentText"}),{children:o,className:i,...a}=n,c=pn(a);return r.jsx(dn,{component:"p",variant:"body1",color:"textSecondary",ref:s,ownerState:a,className:ne(c.root,i),...n,classes:c})}),fn=t=>{const{classes:e}=t;return qe({root:["root"]},an,e)},gn=te(V,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),ls=h.forwardRef(function(e,s){const n=ze({props:e,name:"MuiDialogTitle"}),{className:o,id:i,...a}=n,c=n,l=fn(c),{titleId:p=i}=h.useContext(rn);return r.jsx(gn,{component:"h2",className:ne(l.root,o),ownerState:c,ref:s,variant:"h6",id:i??p,...a})});function mn(t,e,s){const n=e.getBoundingClientRect(),o=s&&s.getBoundingClientRect(),i=es(e);let a;if(e.fakeTransform)a=e.fakeTransform;else{const p=i.getComputedStyle(e);a=p.getPropertyValue("-webkit-transform")||p.getPropertyValue("transform")}let c=0,l=0;if(a&&a!=="none"&&typeof a=="string"){const p=a.split("(")[1].split(")")[0].split(",");c=parseInt(p[4],10),l=parseInt(p[5],10)}return t==="left"?o?`translateX(${o.right+c-n.left}px)`:`translateX(${i.innerWidth+c-n.left}px)`:t==="right"?o?`translateX(-${n.right-o.left-c}px)`:`translateX(-${n.left+n.width-c}px)`:t==="up"?o?`translateY(${o.bottom+l-n.top}px)`:`translateY(${i.innerHeight+l-n.top}px)`:o?`translateY(-${n.top-o.top+n.height-l}px)`:`translateY(-${n.top+n.height-l}px)`}function yn(t){return typeof t=="function"?t():t}function Xe(t,e,s){const n=yn(s),o=mn(t,e,n);o&&(e.style.webkitTransform=o,e.style.transform=o)}const bn=h.forwardRef(function(e,s){const n=he(),o={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:c=!0,children:l,container:p,direction:d="down",easing:g=o,in:_,onEnter:m,onEntered:u,onEntering:E,onExit:O,onExited:A,onExiting:x,style:w,timeout:b=i,TransitionComponent:M=Ps,...F}=e,j=h.useRef(null),k=Tt(Zt(l),j,s),f=y=>N=>{y&&(N===void 0?y(j.current):y(j.current,N))},L=f((y,N)=>{Xe(d,y,p),Fs(y),m&&m(y,N)}),U=f((y,N)=>{const K=It({timeout:b,style:w,easing:g},{mode:"enter"});y.style.webkitTransition=n.transitions.create("-webkit-transform",{...K}),y.style.transition=n.transitions.create("transform",{...K}),y.style.webkitTransform="none",y.style.transform="none",E&&E(y,N)}),pe=f(u),H=f(x),se=f(y=>{const N=It({timeout:b,style:w,easing:g},{mode:"exit"});y.style.webkitTransition=n.transitions.create("-webkit-transform",N),y.style.transition=n.transitions.create("transform",N),Xe(d,y,p),O&&O(y)}),ye=f(y=>{y.style.webkitTransition="",y.style.transition="",A&&A(y)}),z=y=>{a&&a(j.current,y)},$=h.useCallback(()=>{j.current&&Xe(d,j.current,p)},[d,p]);return h.useEffect(()=>{if(_||d==="down"||d==="right")return;const y=Ds(()=>{j.current&&Xe(d,j.current,p)}),N=es(j.current);return N.addEventListener("resize",y),()=>{y.clear(),N.removeEventListener("resize",y)}},[d,_,p]),h.useEffect(()=>{_||$()},[_,$]),r.jsx(M,{nodeRef:j,onEnter:L,onEntered:pe,onEntering:U,onExit:se,onExited:ye,onExiting:H,addEndListener:z,appear:c,in:_,timeout:b,...F,children:(y,{ownerState:N,...K})=>h.cloneElement(l,{ref:k,style:{visibility:y==="exited"&&!_?"hidden":void 0,...w,...l.props.style},...K})})});function xn(t){return it("MuiFab",t)}const Vt=at("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),wn=t=>{const{color:e,variant:s,classes:n,size:o}=t,i={root:["root",s,`size${xe(o)}`,e==="inherit"?"colorInherit":e]},a=qe(i,xn,n);return{...n,...a}},vn=te($s,{name:"MuiFab",slot:"Root",shouldForwardProp:t=>Jt(t)||t==="classes",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.root,e[s.variant],e[`size${xe(s.size)}`],s.color==="inherit"&&e.colorInherit,e[xe(s.size)],e[s.color]]}})(ge(({theme:t})=>{var e,s;return{...t.typography.button,minHeight:36,transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(t.vars||t).zIndex.fab,boxShadow:(t.vars||t).shadows[6],"&:active":{boxShadow:(t.vars||t).shadows[12]},color:t.vars?t.vars.palette.grey[900]:(s=(e=t.palette).getContrastText)==null?void 0:s.call(e,t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],"&:hover":{backgroundColor:(t.vars||t).palette.grey.A100,"@media (hover: none)":{backgroundColor:(t.vars||t).palette.grey[300]},textDecoration:"none"},[`&.${Vt.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),ge(({theme:t})=>({variants:[...Object.entries(t.palette).filter(Vs(["dark","contrastText"])).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].contrastText,backgroundColor:(t.vars||t).palette[e].main,"&:hover":{backgroundColor:(t.vars||t).palette[e].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e].main}}}}))]})),ge(({theme:t})=>({[`&.${Vt.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}))),Ut=h.forwardRef(function(e,s){const n=ze({props:e,name:"MuiFab"}),{children:o,className:i,color:a="default",component:c="button",disabled:l=!1,disableFocusRipple:p=!1,focusVisibleClassName:d,size:g="large",variant:_="circular",...m}=n,u={...n,color:a,component:c,disabled:l,disableFocusRipple:p,size:g,variant:_},E=wn(u);return r.jsx(vn,{className:ne(E.root,i),component:c,disabled:l,focusRipple:!p,focusVisibleClassName:ne(E.focusVisible,d),ownerState:u,ref:s,...m,classes:E,children:o})}),_n=ue(r.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),kn=ue(r.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}));function Cn(t){return it("MuiRating",t)}const De=at("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]);function Rn(t){const e=t.toString().split(".")[1];return e?e.length:0}function mt(t,e){if(t==null)return t;const s=Math.round(t/e)*e;return Number(s.toFixed(Rn(e)))}const Sn=t=>{const{classes:e,size:s,readOnly:n,disabled:o,emptyValueFocused:i,focusVisible:a}=t,c={root:["root",`size${xe(s)}`,o&&"disabled",a&&"focusVisible",n&&"readOnly"],label:["label","pristine"],labelEmptyValue:[i&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return qe(c,Cn,e)},Tn=te("span",{name:"MuiRating",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[{[`& .${De.visuallyHidden}`]:e.visuallyHidden},e.root,e[`size${xe(s.size)}`],s.readOnly&&e.readOnly]}})(ge(({theme:t})=>({display:"inline-flex",position:"relative",fontSize:t.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${De.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${De.focusVisible} .${De.iconActive}`]:{outline:"1px solid #999"},[`& .${De.visuallyHidden}`]:cn,variants:[{props:{size:"small"},style:{fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:t.typography.pxToRem(30)}},{props:({ownerState:e})=>e.readOnly,style:{pointerEvents:"none"}}]}))),hs=te("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:t},e)=>[e.label,t.emptyValueFocused&&e.labelEmptyValueActive]})({cursor:"inherit",variants:[{props:({ownerState:t})=>t.emptyValueFocused,style:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}}]}),En=te("span",{name:"MuiRating",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.icon,s.iconEmpty&&e.iconEmpty,s.iconFilled&&e.iconFilled,s.iconHover&&e.iconHover,s.iconFocus&&e.iconFocus,s.iconActive&&e.iconActive]}})(ge(({theme:t})=>({display:"flex",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),pointerEvents:"none",variants:[{props:({ownerState:e})=>e.iconActive,style:{transform:"scale(1.2)"}},{props:({ownerState:e})=>e.iconEmpty,style:{color:(t.vars||t).palette.action.disabled}}]}))),An=te("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:t=>Us(t)&&t!=="iconActive",overridesResolver:(t,e)=>{const{iconActive:s}=t;return[e.decimal,s&&e.iconActive]}})({position:"relative",variants:[{props:({iconActive:t})=>t,style:{transform:"scale(1.2)"}}]});function jn(t){const{value:e,...s}=t;return r.jsx("span",{...s})}function zt(t){const{classes:e,disabled:s,emptyIcon:n,focus:o,getLabelText:i,highlightSelectedOnly:a,hover:c,icon:l,IconContainerComponent:p,isActive:d,itemValue:g,labelProps:_,name:m,onBlur:u,onChange:E,onClick:O,onFocus:A,readOnly:x,ownerState:w,ratingValue:b,ratingValueRounded:M,slots:F={},slotProps:j={}}=t,k=a?g===b:g<=b,f=g<=c,L=g<=o,U=g===M,pe=`${m}-${Et()}`,H={slots:F,slotProps:j},[se,ye]=le("icon",{elementType:En,className:ne(e.icon,k?e.iconFilled:e.iconEmpty,f&&e.iconHover,L&&e.iconFocus,d&&e.iconActive),externalForwardedProps:H,ownerState:{...w,iconEmpty:!k,iconFilled:k,iconHover:f,iconFocus:L,iconActive:d},additionalProps:{value:g},internalForwardedProps:{as:p}}),[z,$]=le("label",{elementType:hs,externalForwardedProps:H,ownerState:{...w,emptyValueFocused:void 0},additionalProps:{style:_==null?void 0:_.style,htmlFor:pe}}),y=r.jsx(se,{...ye,children:n&&!k?n:l});return x?r.jsx("span",{..._,children:y}):r.jsxs(h.Fragment,{children:[r.jsxs(z,{...$,children:[y,r.jsx("span",{className:e.visuallyHidden,children:i(g)})]}),r.jsx("input",{className:e.visuallyHidden,onFocus:A,onBlur:u,onChange:E,onClick:O,disabled:s,value:g,id:pe,type:"radio",name:m,checked:U})]})}const On=r.jsx(_n,{fontSize:"inherit"}),Bn=r.jsx(kn,{fontSize:"inherit"});function Ln(t){return`${t||"0"} Star${t!==1?"s":""}`}const Mn=h.forwardRef(function(e,s){const n=ze({name:"MuiRating",props:e}),{component:o="span",className:i,defaultValue:a=null,disabled:c=!1,emptyIcon:l=Bn,emptyLabelText:p="Empty",getLabelText:d=Ln,highlightSelectedOnly:g=!1,icon:_=On,IconContainerComponent:m=jn,max:u=5,name:E,onChange:O,onChangeActive:A,onMouseLeave:x,onMouseMove:w,precision:b=1,readOnly:M=!1,size:F="medium",value:j,slots:k={},slotProps:f={},...L}=n,U=Et(E),[pe,H]=ns({controlled:j,default:a,name:"Rating"}),se=mt(pe,b),ye=ts(),[{hover:z,focus:$},y]=h.useState({hover:-1,focus:-1});let N=se;z!==-1&&(N=z),$!==-1&&(N=$);const[K,ve]=h.useState(!1),_e=h.useRef(),ut=Tt(_e,s),ke=S=>{w&&w(S);const B=_e.current,{right:P,left:Ee,width:de}=B.getBoundingClientRect();let fe;ye?fe=(P-S.clientX)/de:fe=(S.clientX-Ee)/de;let Y=mt(u*fe+b/2,b);Y=zs(Y,b,u),y(ae=>ae.hover===Y&&ae.focus===Y?ae:{hover:Y,focus:Y}),ve(!1),A&&z!==Y&&A(S,Y)},Oe=S=>{x&&x(S);const B=-1;y({hover:B,focus:B}),A&&z!==B&&A(S,B)},Be=S=>{let B=S.target.value===""?null:parseFloat(S.target.value);z!==-1&&(B=z),H(B),O&&O(S,B)},Le=S=>{S.clientX===0&&S.clientY===0||(y({hover:-1,focus:-1}),H(null),O&&parseFloat(S.target.value)===se&&O(S,null))},Ce=S=>{ot(S.target)&&ve(!0);const B=parseFloat(S.target.value);y(P=>({hover:P.hover,focus:B}))},He=S=>{if(z!==-1)return;ot(S.target)||ve(!1);const B=-1;y(P=>({hover:P.hover,focus:B}))},[pt,Me]=h.useState(!1),q={...n,component:o,defaultValue:a,disabled:c,emptyIcon:l,emptyLabelText:p,emptyValueFocused:pt,focusVisible:K,getLabelText:d,icon:_,IconContainerComponent:m,max:u,precision:b,readOnly:M,size:F},X=Sn(q),ie={slots:k,slotProps:f},[Re,We]=le("root",{ref:ut,className:ne(X.root,i),elementType:Tn,externalForwardedProps:{...ie,...L,component:o},getSlotProps:S=>({...S,onMouseMove:B=>{var P;ke(B),(P=S.onMouseMove)==null||P.call(S,B)},onMouseLeave:B=>{var P;Oe(B),(P=S.onMouseLeave)==null||P.call(S,B)}}),ownerState:q,additionalProps:{role:M?"img":null,"aria-label":M?d(N):null}}),[Se,Te]=le("label",{className:ne(X.label,X.labelEmptyValue),elementType:hs,externalForwardedProps:ie,ownerState:q}),[Ne,Ie]=le("decimal",{className:X.decimal,elementType:An,externalForwardedProps:ie,ownerState:q});return r.jsxs(Re,{...We,children:[Array.from(new Array(u)).map((S,B)=>{const P=B+1,Ee={classes:X,disabled:c,emptyIcon:l,focus:$,getLabelText:d,highlightSelectedOnly:g,hover:z,icon:_,IconContainerComponent:m,name:U,onBlur:He,onChange:Be,onClick:Le,onFocus:Ce,ratingValue:N,ratingValueRounded:se,readOnly:M,ownerState:q,slots:k,slotProps:f},de=P===Math.ceil(N)&&(z!==-1||$!==-1);if(b<1){const fe=Array.from(new Array(1/b));return h.createElement(Ne,{...Ie,key:P,className:ne(Ie.className,de&&X.iconActive),iconActive:de},fe.map((Y,ae)=>{const ce=mt(P-1+(ae+1)*b,b);return r.jsx(zt,{...Ee,isActive:!1,itemValue:ce,labelProps:{style:fe.length-1===ae?{}:{width:ce===N?`${(ae+1)*b*100}%`:"0%",overflow:"hidden",position:"absolute"}}},ce)}))}return r.jsx(zt,{...Ee,isActive:de,itemValue:P},P)}),!M&&!c&&r.jsxs(Se,{...Te,children:[r.jsx("input",{className:X.visuallyHidden,value:"",id:`${U}-empty`,type:"radio",name:U,checked:se==null,onFocus:()=>Me(!0),onBlur:()=>Me(!1),onChange:Be}),r.jsx("span",{className:X.visuallyHidden,children:p})]})]})});function Nn(t){return it("MuiTooltip",t)}const I=at("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function In(t){return Math.round(t*1e5)/1e5}const Pn=t=>{const{classes:e,disableInteractive:s,arrow:n,touch:o,placement:i}=t,a={popper:["popper",!s&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",o&&"touch",`tooltipPlacement${xe(i.split("-")[0])}`],arrow:["arrow"]};return qe(a,Nn,e)},Dn=te(os,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.popper,!s.disableInteractive&&e.popperInteractive,s.arrow&&e.popperArrow,!s.open&&e.popperClose]}})(ge(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${I.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${I.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${I.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${I.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${I.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${I.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${I.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${I.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),Fn=te("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.tooltip,s.touch&&e.touch,s.arrow&&e.tooltipArrow,e[`tooltipPlacement${xe(s.placement.split("-")[0])}`]]}})(ge(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${I.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${I.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${I.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${I.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${In(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${I.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${I.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${I.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${I.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${I.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${I.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${I.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${I.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${I.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${I.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),$n=te("span",{name:"MuiTooltip",slot:"Arrow"})(ge(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Qe=!1;const qt=new qs;let Fe={x:0,y:0};function Ge(t,e){return(s,...n)=>{e&&e(s,...n),t(s,...n)}}const Ht=h.forwardRef(function(e,s){const n=ze({props:e,name:"MuiTooltip"}),{arrow:o=!1,children:i,classes:a,components:c={},componentsProps:l={},describeChild:p=!1,disableFocusListener:d=!1,disableHoverListener:g=!1,disableInteractive:_=!1,disableTouchListener:m=!1,enterDelay:u=100,enterNextDelay:E=0,enterTouchDelay:O=700,followCursor:A=!1,id:x,leaveDelay:w=0,leaveTouchDelay:b=1500,onClose:M,onOpen:F,open:j,placement:k="bottom",PopperComponent:f,PopperProps:L={},slotProps:U={},slots:pe={},title:H,TransitionComponent:se,TransitionProps:ye,...z}=n,$=h.isValidElement(i)?i:r.jsx("span",{children:i}),y=he(),N=ts(),[K,ve]=h.useState(),[_e,ut]=h.useState(null),ke=h.useRef(!1),Oe=_||A,Be=Ke(),Le=Ke(),Ce=Ke(),He=Ke(),[pt,Me]=ns({controlled:j,default:!1,name:"Tooltip",state:"open"});let q=pt;const X=Et(x),ie=h.useRef(),Re=Pt(()=>{ie.current!==void 0&&(document.body.style.WebkitUserSelect=ie.current,ie.current=void 0),He.clear()});h.useEffect(()=>Re,[Re]);const We=v=>{qt.clear(),Qe=!0,Me(!0),F&&!q&&F(v)},Se=Pt(v=>{qt.start(800+w,()=>{Qe=!1}),Me(!1),M&&q&&M(v),Be.start(y.transitions.duration.shortest,()=>{ke.current=!1})}),Te=v=>{ke.current&&v.type!=="touchstart"||(K&&K.removeAttribute("title"),Le.clear(),Ce.clear(),u||Qe&&E?Le.start(Qe?E:u,()=>{We(v)}):We(v))},Ne=v=>{Le.clear(),Ce.start(w,()=>{Se(v)})},[,Ie]=h.useState(!1),S=v=>{ot(v.target)||(Ie(!1),Ne(v))},B=v=>{K||ve(v.currentTarget),ot(v.target)&&(Ie(!0),Te(v))},P=v=>{ke.current=!0;const Z=$.props;Z.onTouchStart&&Z.onTouchStart(v)},Ee=v=>{P(v),Ce.clear(),Be.clear(),Re(),ie.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",He.start(O,()=>{document.body.style.WebkitUserSelect=ie.current,Te(v)})},de=v=>{$.props.onTouchEnd&&$.props.onTouchEnd(v),Re(),Ce.start(b,()=>{Se(v)})};h.useEffect(()=>{if(!q)return;function v(Z){Z.key==="Escape"&&Se(Z)}return document.addEventListener("keydown",v),()=>{document.removeEventListener("keydown",v)}},[Se,q]);const fe=Tt(Zt($),ve,s);!H&&H!==0&&(q=!1);const Y=h.useRef(),ae=v=>{const Z=$.props;Z.onMouseMove&&Z.onMouseMove(v),Fe={x:v.clientX,y:v.clientY},Y.current&&Y.current.update()},ce={},dt=typeof H=="string";p?(ce.title=!q&&dt&&!g?H:null,ce["aria-describedby"]=q?X:null):(ce["aria-label"]=dt?H:null,ce["aria-labelledby"]=q&&!dt?X:null);const G={...ce,...z,...$.props,className:ne(z.className,$.props.className),onTouchStart:P,ref:fe,...A?{onMouseMove:ae}:{}},Pe={};m||(G.onTouchStart=Ee,G.onTouchEnd=de),g||(G.onMouseOver=Ge(Te,G.onMouseOver),G.onMouseLeave=Ge(Ne,G.onMouseLeave),Oe||(Pe.onMouseOver=Te,Pe.onMouseLeave=Ne)),d||(G.onFocus=Ge(B,G.onFocus),G.onBlur=Ge(S,G.onBlur),Oe||(Pe.onFocus=B,Pe.onBlur=S));const be={...n,isRtl:N,arrow:o,disableInteractive:Oe,placement:k,PopperComponentProp:f,touch:ke.current},J=typeof U.popper=="function"?U.popper(be):U.popper,Ts=h.useMemo(()=>{var Z,Nt;let v=[{name:"arrow",enabled:!!_e,options:{element:_e,padding:4}}];return(Z=L.popperOptions)!=null&&Z.modifiers&&(v=v.concat(L.popperOptions.modifiers)),(Nt=J==null?void 0:J.popperOptions)!=null&&Nt.modifiers&&(v=v.concat(J.popperOptions.modifiers)),{...L.popperOptions,...J==null?void 0:J.popperOptions,modifiers:v}},[_e,L.popperOptions,J==null?void 0:J.popperOptions]),ft=Pn(be),Es=typeof U.transition=="function"?U.transition(be):U.transition,Ye={slots:{popper:c.Popper,transition:c.Transition??se,tooltip:c.Tooltip,arrow:c.Arrow,...pe},slotProps:{arrow:U.arrow??l.arrow,popper:{...L,...J??l.popper},tooltip:U.tooltip??l.tooltip,transition:{...ye,...Es??l.transition}}},[As,js]=le("popper",{elementType:Dn,externalForwardedProps:Ye,ownerState:be,className:ne(ft.popper,L==null?void 0:L.className)}),[Os,Bs]=le("transition",{elementType:Hs,externalForwardedProps:Ye,ownerState:be}),[Ls,Ms]=le("tooltip",{elementType:Fn,className:ft.tooltip,externalForwardedProps:Ye,ownerState:be}),[Ns,Is]=le("arrow",{elementType:$n,className:ft.arrow,externalForwardedProps:Ye,ownerState:be,ref:ut});return r.jsxs(h.Fragment,{children:[h.cloneElement($,G),r.jsx(As,{as:f??os,placement:k,anchorEl:A?{getBoundingClientRect:()=>({top:Fe.y,left:Fe.x,right:Fe.x,bottom:Fe.y,width:0,height:0})}:K,popperRef:Y,open:K?q:!1,id:X,transition:!0,...Pe,...js,popperOptions:Ts,children:({TransitionProps:v})=>r.jsx(Os,{timeout:y.transitions.duration.shorter,...v,...Bs,children:r.jsxs(Ls,{...Ms,children:[H,o?r.jsx(Ns,{...Is}):null]})})})]})}),Vn=({workspace:t,onClick:e,selected:s})=>{const n=o=>{e(o,t)};return r.jsx(W,{onClick:n,sx:{width:"100%",backgroundColor:s?"#ccc":"#fff",cursor:"pointer"},p:2,children:r.jsx(T,{direction:"row",alignItems:"center",justifyContent:"space-between",children:r.jsx(T,{direction:"row",spacing:2,children:r.jsxs(T,{spacing:.3,children:[r.jsx(V,{variant:"subtitle2",children:t.name}),r.jsx(V,{variant:"caption",color:"#333",fontStyle:"italic",children:t.address})]})})})})},re=Object.create(null);re.open="0";re.close="1";re.ping="2";re.pong="3";re.message="4";re.upgrade="5";re.noop="6";const et=Object.create(null);Object.keys(re).forEach(t=>{et[re[t]]=t});const vt={type:"error",data:"parser error"},us=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",ps=typeof ArrayBuffer=="function",ds=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,At=({type:t,data:e},s,n)=>us&&e instanceof Blob?s?n(e):Wt(e,n):ps&&(e instanceof ArrayBuffer||ds(e))?s?n(e):Wt(new Blob([e]),n):n(re[t]+(e||"")),Wt=(t,e)=>{const s=new FileReader;return s.onload=function(){const n=s.result.split(",")[1];e("b"+(n||""))},s.readAsDataURL(t)};function Yt(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let yt;function Un(t,e){if(us&&t.data instanceof Blob)return t.data.arrayBuffer().then(Yt).then(e);if(ps&&(t.data instanceof ArrayBuffer||ds(t.data)))return e(Yt(t.data));At(t,!1,s=>{yt||(yt=new TextEncoder),e(yt.encode(s))})}const Kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ve=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<Kt.length;t++)Ve[Kt.charCodeAt(t)]=t;const zn=t=>{let e=t.length*.75,s=t.length,n,o=0,i,a,c,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const p=new ArrayBuffer(e),d=new Uint8Array(p);for(n=0;n<s;n+=4)i=Ve[t.charCodeAt(n)],a=Ve[t.charCodeAt(n+1)],c=Ve[t.charCodeAt(n+2)],l=Ve[t.charCodeAt(n+3)],d[o++]=i<<2|a>>4,d[o++]=(a&15)<<4|c>>2,d[o++]=(c&3)<<6|l&63;return p},qn=typeof ArrayBuffer=="function",jt=(t,e)=>{if(typeof t!="string")return{type:"message",data:fs(t,e)};const s=t.charAt(0);return s==="b"?{type:"message",data:Hn(t.substring(1),e)}:et[s]?t.length>1?{type:et[s],data:t.substring(1)}:{type:et[s]}:vt},Hn=(t,e)=>{if(qn){const s=zn(t);return fs(s,e)}else return{base64:!0,data:t}},fs=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},gs="",Wn=(t,e)=>{const s=t.length,n=new Array(s);let o=0;t.forEach((i,a)=>{At(i,!1,c=>{n[a]=c,++o===s&&e(n.join(gs))})})},Yn=(t,e)=>{const s=t.split(gs),n=[];for(let o=0;o<s.length;o++){const i=jt(s[o],e);if(n.push(i),i.type==="error")break}return n};function Kn(){return new TransformStream({transform(t,e){Un(t,s=>{const n=s.length;let o;if(n<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,n);else if(n<65536){o=new Uint8Array(3);const i=new DataView(o.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{o=new Uint8Array(9);const i=new DataView(o.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(o[0]|=128),e.enqueue(o),e.enqueue(s)})}})}let bt;function Je(t){return t.reduce((e,s)=>e+s.length,0)}function Ze(t,e){if(t[0].length===e)return t.shift();const s=new Uint8Array(e);let n=0;for(let o=0;o<e;o++)s[o]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),s}function Xn(t,e){bt||(bt=new TextDecoder);const s=[];let n=0,o=-1,i=!1;return new TransformStream({transform(a,c){for(s.push(a);;){if(n===0){if(Je(s)<1)break;const l=Ze(s,1);i=(l[0]&128)===128,o=l[0]&127,o<126?n=3:o===126?n=1:n=2}else if(n===1){if(Je(s)<2)break;const l=Ze(s,2);o=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),n=3}else if(n===2){if(Je(s)<8)break;const l=Ze(s,8),p=new DataView(l.buffer,l.byteOffset,l.length),d=p.getUint32(0);if(d>Math.pow(2,21)-1){c.enqueue(vt);break}o=d*Math.pow(2,32)+p.getUint32(4),n=3}else{if(Je(s)<o)break;const l=Ze(s,o);c.enqueue(jt(i?l:bt.decode(l),e)),n=0}if(o===0||o>t){c.enqueue(vt);break}}}})}const ms=4;function D(t){if(t)return Qn(t)}function Qn(t){for(var e in D.prototype)t[e]=D.prototype[e];return t}D.prototype.on=D.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};D.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this};D.prototype.off=D.prototype.removeListener=D.prototype.removeAllListeners=D.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,o=0;o<s.length;o++)if(n=s[o],n===e||n.fn===e){s.splice(o,1);break}return s.length===0&&delete this._callbacks["$"+t],this};D.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(s){s=s.slice(0);for(var n=0,o=s.length;n<o;++n)s[n].apply(this,e)}return this};D.prototype.emitReserved=D.prototype.emit;D.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};D.prototype.hasListeners=function(t){return!!this.listeners(t).length};const ct=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,s)=>s(e,0),Q=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Gn="arraybuffer";function ys(t,...e){return e.reduce((s,n)=>(t.hasOwnProperty(n)&&(s[n]=t[n]),s),{})}const Jn=Q.setTimeout,Zn=Q.clearTimeout;function lt(t,e){e.useNativeTimers?(t.setTimeoutFn=Jn.bind(Q),t.clearTimeoutFn=Zn.bind(Q)):(t.setTimeoutFn=Q.setTimeout.bind(Q),t.clearTimeoutFn=Q.clearTimeout.bind(Q))}const eo=1.33;function to(t){return typeof t=="string"?so(t):Math.ceil((t.byteLength||t.size)*eo)}function so(t){let e=0,s=0;for(let n=0,o=t.length;n<o;n++)e=t.charCodeAt(n),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(n++,s+=4);return s}function bs(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function no(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}function oo(t){let e={},s=t.split("&");for(let n=0,o=s.length;n<o;n++){let i=s[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class ro extends Error{constructor(e,s,n){super(e),this.description=s,this.context=n,this.type="TransportError"}}class Ot extends D{constructor(e){super(),this.writable=!1,lt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,s,n){return super.emitReserved("error",new ro(e,s,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const s=jt(e,this.socket.binaryType);this.onPacket(s)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,s={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const s=no(e);return s.length?"?"+s:""}}class io extends Ot{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const s=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||s()})),this.writable||(n++,this.once("drain",function(){--n||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const s=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};Yn(e,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Wn(e,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=bs()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(e,s)}}let xs=!1;try{xs=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ao=xs;function co(){}class lo extends io{constructor(e){if(super(e),typeof location<"u"){const s=location.protocol==="https:";let n=location.port;n||(n=s?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,s){const n=this.request({method:"POST",data:e});n.on("success",s),n.on("error",(o,i)=>{this.onError("xhr post error",o,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(s,n)=>{this.onError("xhr poll error",s,n)}),this.pollXhr=e}}class oe extends D{constructor(e,s,n){super(),this.createRequest=e,lt(this,n),this._opts=n,this._method=n.method||"GET",this._uri=s,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const s=ys(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(s);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var o;n.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=oe.requestsCount++,oe.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=co,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete oe.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}oe.requestsCount=0;oe.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Xt);else if(typeof addEventListener=="function"){const t="onpagehide"in Q?"pagehide":"unload";addEventListener(t,Xt,!1)}}function Xt(){for(let t in oe.requests)oe.requests.hasOwnProperty(t)&&oe.requests[t].abort()}const ho=(function(){const t=ws({xdomain:!1});return t&&t.responseType!==null})();class uo extends lo{constructor(e){super(e);const s=e&&e.forceBase64;this.supportsBinary=ho&&!s}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new oe(ws,this.uri(),e)}}function ws(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||ao))return new XMLHttpRequest}catch{}if(!e)try{return new Q[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const vs=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class po extends Ot{get name(){return"websocket"}doOpen(){const e=this.uri(),s=this.opts.protocols,n=vs?{}:ys(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,s,n)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],o=s===e.length-1;At(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}o&&ct(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=bs()),this.supportsBinary||(s.b64=1),this.createUri(e,s)}}const xt=Q.WebSocket||Q.MozWebSocket;class fo extends po{createSocket(e,s,n){return vs?new xt(e,s,n):s?new xt(e,s):new xt(e)}doWrite(e,s){this.ws.send(s)}}class go extends Ot{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const s=Xn(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(s).getReader(),o=Kn();o.readable.pipeTo(e.writable),this._writer=o.writable.getWriter();const i=()=>{n.read().then(({done:c,value:l})=>{c||(this.onPacket(l),i())}).catch(c=>{})};i();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],o=s===e.length-1;this._writer.write(n).then(()=>{o&&ct(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const mo={websocket:fo,webtransport:go,polling:uo},yo=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,bo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function _t(t){if(t.length>8e3)throw"URI too long";const e=t,s=t.indexOf("["),n=t.indexOf("]");s!=-1&&n!=-1&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));let o=yo.exec(t||""),i={},a=14;for(;a--;)i[bo[a]]=o[a]||"";return s!=-1&&n!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=xo(i,i.path),i.queryKey=wo(i,i.query),i}function xo(t,e){const s=/\/{2,9}/g,n=e.replace(s,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function wo(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,o,i){o&&(s[o]=i)}),s}const kt=typeof addEventListener=="function"&&typeof removeEventListener=="function",tt=[];kt&&addEventListener("offline",()=>{tt.forEach(t=>t())},!1);class me extends D{constructor(e,s){if(super(),this.binaryType=Gn,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(s=e,e=null),e){const n=_t(e);s.hostname=n.host,s.secure=n.protocol==="https"||n.protocol==="wss",s.port=n.port,n.query&&(s.query=n.query)}else s.host&&(s.hostname=_t(s.host).host);lt(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(n=>{const o=n.prototype.name;this.transports.push(o),this._transportsByName[o]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=oo(this.opts.query)),kt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},tt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const s=Object.assign({},this.opts.query);s.EIO=ms,s.transport=e,this.id&&(s.sid=this.id);const n=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&me.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(e);s.open(),this.setTransport(s)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",me.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=e.data,this._onError(s);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let n=0;n<this.writeBuffer.length;n++){const o=this.writeBuffer[n].data;if(o&&(s+=to(o)),n>0&&s>this._maxPayload)return this.writeBuffer.slice(0,n);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,ct(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,s,n){return this._sendPacket("message",e,s,n),this}send(e,s,n){return this._sendPacket("message",e,s,n),this}_sendPacket(e,s,n,o){if(typeof s=="function"&&(o=s,s=void 0),typeof n=="function"&&(o=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:e,data:s,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),o&&this.once("flush",o),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),e()},n=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(me.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),kt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=tt.indexOf(this._offlineEventListener);n!==-1&&tt.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,s),this.writeBuffer=[],this._prevBufferLen=0}}}me.protocol=ms;class vo extends me{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let s=this.createTransport(e),n=!1;me.priorWebsocketSuccess=!1;const o=()=>{n||(s.send([{type:"ping",data:"probe"}]),s.once("packet",g=>{if(!n)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;me.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const _=new Error("probe error");_.transport=s.name,this.emitReserved("upgradeError",_)}}))};function i(){n||(n=!0,d(),s.close(),s=null)}const a=g=>{const _=new Error("probe error: "+g);_.transport=s.name,i(),this.emitReserved("upgradeError",_)};function c(){a("transport closed")}function l(){a("socket closed")}function p(g){s&&g.name!==s.name&&i()}const d=()=>{s.removeListener("open",o),s.removeListener("error",a),s.removeListener("close",c),this.off("close",l),this.off("upgrading",p)};s.once("open",o),s.once("error",a),s.once("close",c),this.once("close",l),this.once("upgrading",p),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||s.open()},200):s.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const s=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&s.push(e[n]);return s}}let _o=class extends vo{constructor(e,s={}){const n=typeof e=="object"?e:s;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(o=>mo[o]).filter(o=>!!o)),super(e,n)}};function ko(t,e="",s){let n=t;s=s||typeof location<"u"&&location,t==null&&(t=s.protocol+"//"+s.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=s.protocol+t:t=s.host+t),/^(https?|wss?):\/\//.test(t)||(typeof s<"u"?t=s.protocol+"//"+t:t="https://"+t),n=_t(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(s&&s.port===n.port?"":":"+n.port),n}const Co=typeof ArrayBuffer=="function",Ro=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,_s=Object.prototype.toString,So=typeof Blob=="function"||typeof Blob<"u"&&_s.call(Blob)==="[object BlobConstructor]",To=typeof File=="function"||typeof File<"u"&&_s.call(File)==="[object FileConstructor]";function Bt(t){return Co&&(t instanceof ArrayBuffer||Ro(t))||So&&t instanceof Blob||To&&t instanceof File}function st(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let s=0,n=t.length;s<n;s++)if(st(t[s]))return!0;return!1}if(Bt(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return st(t.toJSON(),!0);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&st(t[s]))return!0;return!1}function Eo(t){const e=[],s=t.data,n=t;return n.data=Ct(s,e),n.attachments=e.length,{packet:n,buffers:e}}function Ct(t,e){if(!t)return t;if(Bt(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}else if(Array.isArray(t)){const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=Ct(t[n],e);return s}else if(typeof t=="object"&&!(t instanceof Date)){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=Ct(t[n],e));return s}return t}function Ao(t,e){return t.data=Rt(t.data,e),delete t.attachments,t}function Rt(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=Rt(t[s],e);else if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=Rt(t[s],e));return t}const jo=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Oo=5;var R;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(R||(R={}));class Bo{constructor(e){this.replacer=e}encode(e){return(e.type===R.EVENT||e.type===R.ACK)&&st(e)?this.encodeAsBinary({type:e.type===R.EVENT?R.BINARY_EVENT:R.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let s=""+e.type;return(e.type===R.BINARY_EVENT||e.type===R.BINARY_ACK)&&(s+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(s+=e.nsp+","),e.id!=null&&(s+=e.id),e.data!=null&&(s+=JSON.stringify(e.data,this.replacer)),s}encodeAsBinary(e){const s=Eo(e),n=this.encodeAsString(s.packet),o=s.buffers;return o.unshift(n),o}}function Qt(t){return Object.prototype.toString.call(t)==="[object Object]"}class Lt extends D{constructor(e){super(),this.reviver=e}add(e){let s;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(e);const n=s.type===R.BINARY_EVENT;n||s.type===R.BINARY_ACK?(s.type=n?R.EVENT:R.ACK,this.reconstructor=new Lo(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(Bt(e)||e.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(e),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let s=0;const n={type:Number(e.charAt(0))};if(R[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===R.BINARY_EVENT||n.type===R.BINARY_ACK){const i=s+1;for(;e.charAt(++s)!=="-"&&s!=e.length;);const a=e.substring(i,s);if(a!=Number(a)||e.charAt(s)!=="-")throw new Error("Illegal attachments");n.attachments=Number(a)}if(e.charAt(s+1)==="/"){const i=s+1;for(;++s&&!(e.charAt(s)===","||s===e.length););n.nsp=e.substring(i,s)}else n.nsp="/";const o=e.charAt(s+1);if(o!==""&&Number(o)==o){const i=s+1;for(;++s;){const a=e.charAt(s);if(a==null||Number(a)!=a){--s;break}if(s===e.length)break}n.id=Number(e.substring(i,s+1))}if(e.charAt(++s)){const i=this.tryParse(e.substr(s));if(Lt.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,s){switch(e){case R.CONNECT:return Qt(s);case R.DISCONNECT:return s===void 0;case R.CONNECT_ERROR:return typeof s=="string"||Qt(s);case R.EVENT:case R.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&jo.indexOf(s[0])===-1);case R.ACK:case R.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Lo{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const s=Ao(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Mo=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Lt,Encoder:Bo,get PacketType(){return R},protocol:Oo},Symbol.toStringTag,{value:"Module"}));function ee(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const No=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ks extends D{constructor(e,s,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=s,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ee(e,"open",this.onopen.bind(this)),ee(e,"packet",this.onpacket.bind(this)),ee(e,"error",this.onerror.bind(this)),ee(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...s){var n,o,i;if(No.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const a={type:R.EVENT,data:s};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const d=this.ids++,g=s.pop();this._registerAckCallback(d,g),a.id=d}const c=(o=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||o===void 0?void 0:o.writable,l=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(l?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(e,s){var n;const o=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(o===void 0){this.acks[e]=s;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===e&&this.sendBuffer.splice(c,1);s.call(this,new Error("operation has timed out"))},o),a=(...c)=>{this.io.clearTimeoutFn(i),s.apply(this,c)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...s){return new Promise((n,o)=>{const i=(a,c)=>a?o(a):n(c);i.withError=!0,s.push(i),this.emit(e,...s)})}_addToQueue(e){let s;typeof e[e.length-1]=="function"&&(s=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((o,...i)=>n!==this._queue[0]?void 0:(o!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(o)):(this._queue.shift(),s&&s(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!e||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:R.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case R.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case R.EVENT:case R.BINARY_EVENT:this.onevent(e);break;case R.ACK:case R.BINARY_ACK:this.onack(e);break;case R.DISCONNECT:this.ondisconnect();break;case R.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const s=e.data||[];e.id!=null&&s.push(this.ack(e.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const n of s)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const s=this;let n=!1;return function(...o){n||(n=!0,s.packet({type:R.ACK,id:e,data:o}))}}onack(e){const s=this.acks[e.id];typeof s=="function"&&(delete this.acks[e.id],s.withError&&e.data.unshift(null),s.apply(this,e.data))}onconnect(e,s){this.id=e,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:R.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const s=this._anyListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const s=this._anyOutgoingListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const n of s)n.apply(this,e.data)}}}function Ae(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Ae.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-s:t+s}return Math.min(t,this.max)|0};Ae.prototype.reset=function(){this.attempts=0};Ae.prototype.setMin=function(t){this.ms=t};Ae.prototype.setMax=function(t){this.max=t};Ae.prototype.setJitter=function(t){this.jitter=t};class St extends D{constructor(e,s){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(s=e,e=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,lt(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((n=s.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Ae({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=e;const o=s.parser||Mo;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var s;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(s=this.backoff)===null||s===void 0||s.setMin(e),this)}randomizationFactor(e){var s;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(s=this.backoff)===null||s===void 0||s.setJitter(e),this)}reconnectionDelayMax(e){var s;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(s=this.backoff)===null||s===void 0||s.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new _o(this.uri,this.opts);const s=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const o=ee(s,"open",function(){n.onopen(),e&&e()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),e?e(c):this.maybeReconnectOnOpen()},a=ee(s,"error",i);if(this._timeout!==!1){const c=this._timeout,l=this.setTimeoutFn(()=>{o(),i(new Error("timeout")),s.close()},c);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(o),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ee(e,"ping",this.onping.bind(this)),ee(e,"data",this.ondata.bind(this)),ee(e,"error",this.onerror.bind(this)),ee(e,"close",this.onclose.bind(this)),ee(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(s){this.onclose("parse error",s)}}ondecoded(e){ct(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,s){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new ks(this,e,s),this.nsps[e]=n),n}_destroy(e){const s=Object.keys(this.nsps);for(const n of s)if(this.nsps[n].active)return;this._close()}_packet(e){const s=this.encoder.encode(e);for(let n=0;n<s.length;n++)this.engine.write(s[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,s){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(o=>{o?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",o)):e.onreconnect()}))},s);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const $e={};function nt(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const s=ko(t,e.path||"/socket.io"),n=s.source,o=s.id,i=s.path,a=$e[o]&&i in $e[o].nsps,c=e.forceNew||e["force new connection"]||e.multiplex===!1||a;let l;return c?l=new St(n,e):($e[o]||($e[o]=new St(n,e)),l=$e[o]),s.query&&!e.query&&(e.query=s.queryKey),l.socket(s.path,e)}Object.assign(nt,{Manager:St,Socket:ks,io:nt,connect:nt});const Io=Ws()||"https://admake.vn",C=nt(Io,{path:"/socket.io",autoConnect:!1,transports:["websocket"]});function Gt(){return Date.now()*1e3+Math.floor(Math.random()*1e3)}const Po=ue(r.jsx("path",{d:"m9.4 10.5 4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35zM21.54 9c-.92-2.92-3.15-5.26-6-6.34L11.88 9zm.26 1h-7.49l.29.5 4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2M8.54 12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 2h7.49zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 15zm11.27 0-3.9 6.76c.7.15 1.42.24 2.17.24 2.4 0 4.6-.85 6.32-2.25l-3.66-6.35z"})),Do=ue(r.jsx("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm7 7V3.5L18.5 9z"})),Fo=ue(r.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),$o=ue([r.jsx("circle",{cx:"15.5",cy:"9.5",r:"1.5"},"0"),r.jsx("circle",{cx:"8.5",cy:"9.5",r:"1.5"},"1"),r.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m0-4c-.73 0-1.38-.18-1.96-.52-.12.14-.86.98-1.01 1.15.86.55 1.87.87 2.97.87 1.11 0 2.12-.33 2.98-.88-.97-1.09-.01-.02-1.01-1.15-.59.35-1.24.53-1.97.53"},"2")]),Vo=ue(r.jsx("path",{d:"M1 21h4V9H1zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73z"})),Cs=h.createContext(void 0),pr=({children:t})=>{const[e,s]=h.useState(null);return r.jsx(Cs.Provider,{value:{workspaceEl:e,setWorkspaceEl:s},children:t})},ht=()=>{const t=h.useContext(Cs);if(t===void 0)throw new Error("useChatGroup must be used within a ChatGroupProvider");return t},Uo=te(nn)(({theme:t})=>({"& .MuiInputBase-input":{paddingTop:"12px",paddingBottom:"12px"}})),zo=[{color:"#ddd",icon:r.jsx(Po,{fontSize:"large"}),y:50,title:"Image"}],qo=t=>{let e="msg";if(t!==""){e="doc";const s=t.toLowerCase();t.startsWith("http")||t.startsWith("www")?e="link":[".jpg",".png",".gif",".webp",".mp4",".avi",".jfif"].some(n=>s.includes(n))&&(e="img")}return e};function Ho(t,e=2){if(t===0)return"0 Bytes";const s=1024,n=e<0?0:e,o=["Bytes","KB","MB","GB","TB"],i=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,i)).toFixed(n))+" "+o[i]}const Wo=h.forwardRef(({inputValue:t,setInputValue:e,setOpenPicker:s,handleSendMessage:n},o)=>{const[i,a]=h.useState(!1),{userId:c,username:l,userRoleId:p,userIcon:d}=we(),{workspaceEl:g,setWorkspaceEl:_}=ht(),m=async()=>{a(u=>!u);try{const u=document.createElement("input");u.type="file",u.onchange=async E=>{const O=E.target;if(!O.files)return;const A=O.files[0];if(!A)return;if(A.size/(1024*1024)>100){gt.error({message:"Kch thc file vt qu 100MB, vui lng chn file nh hn."});return}const w=new FormData;w.append("file",A),w.append("groupId",(g==null?void 0:g.id.toString())||""),w.append("role",p.toString()),w.append("userId",(c==null?void 0:c.toString())||"");for(const[j,k]of w.entries())console.log(`${j}: ${k}`);console.log("Upload"),console.log(Array.from(w.entries()));const b=await fetch(`${ss()}/message/upload`,{method:"POST",body:w});if(!b.ok){const j=await b.text();throw new Error(`File upload failed: ${b.status} ${b.statusText} - ${j}`)}const F=`${(await b.json()).filename}`;n(`${new Date(Date.now()).toLocaleString()}-${Ho(A.size)}`,F),console.log("Document message sent successfully")},u.click()}catch(u){u instanceof Error?(console.error(u.message),gt.error({message:"Upload document failed",description:u.message})):(console.error("Unknown error",u),gt.error({message:"Upload document failed"}))}};return r.jsx(Uo,{value:t,onChange:u=>e(u.target.value),fullWidth:!0,placeholder:"Write a message...",variant:"filled",onKeyDown:u=>{u.key==="Enter"&&(u.preventDefault(),n(t,""))},InputProps:{disableUnderline:!0,startAdornment:r.jsxs(T,{sx:{width:"max-content",mt:-2},children:[r.jsxs(T,{sx:{position:"relative",display:i?"inline-block":"none"},children:[zo.map((u,E)=>r.jsx(Ht,{placement:"right",title:u.title,children:r.jsx(Ut,{sx:{position:"absolute",top:-u.y,backgroundColor:u.color},children:u.icon})},`ActionItem-${E}`)),r.jsx(Ht,{placement:"right",title:"Document",children:r.jsx(Ut,{onClick:()=>m(),sx:{position:"absolute",top:-120,backgroundColor:"#0159b2"},children:r.jsx(Do,{fontSize:"large"})})})]}),r.jsx(Dt,{position:"start",children:r.jsx(Ue,{onClick:()=>a(u=>!u),children:r.jsx(Fo,{})})})]}),endAdornment:r.jsx(Dt,{position:"end",children:r.jsx(Ue,{onClick:()=>s(u=>!u),children:r.jsx($o,{})})})}})}),Yo=h.forwardRef(({setMessages:t,left:e,width:s},n)=>{const{userId:o,username:i,userRoleId:a,isMobile:c}=we(),[l,p]=h.useState(!1),[d,g]=h.useState(""),_=a===-2,{workspaceEl:m}=ht();h.useEffect(()=>(C.connect(),console.log("WebSocket URL:",C.io.engine.transport.uri),C.on("connect",()=>{console.log("Connected to server",C.id),C.emit("join",{workspace_id:m==null?void 0:m.id})}),C.on("admake/chat/message",x=>{console.log("Received message:",x)}),C.on("disconnect",()=>{console.log("Disconnected from server")}),C.on("admake/chat/message_ack",x=>{t(w=>w.map(b=>b.message_id===x.message_id?{...b,status:"success",message_id:x.message_id}:b))}),()=>{C.off("connect"),C.off("admake/chat/message"),C.off("disconnect"),C.disconnect()}),[m==null?void 0:m.id]);function u(){const x=JSON.parse(localStorage.getItem("Admake-User-Access")||"{}");return(x==null?void 0:x.username)||""}function E(){const x=new Date,w=(F,j)=>F.toString().padStart(j,"0"),b=x.getUTCFullYear().toString()+w(x.getUTCMonth()+1,2)+w(x.getUTCDate(),2)+w(x.getUTCHours(),2)+w(x.getUTCMinutes(),2)+w(x.getUTCSeconds(),2)+w(x.getUTCMilliseconds(),3),M=Array.from({length:6},()=>Math.floor(Math.random()*16).toString(16)).join("");return b+M}const O=(x,w="")=>{if(!(!x||x==="")){if(C.connected){const b=Date.now();console.log("Username",u());const M={id:Gt(),workspace_id:(m==null?void 0:m.id)||"",react:{rate:0},preview:"",reply:"",role:a,icon:"",type:qo(w),incoming:!1,user_id:o,username:u(),text:x,file_url:w,link:"",message_id:`msg-${E()}`,is_favourite:!1,createdAt:new Date(b),updatedAt:new Date(b),deletedAt:null,status:"sending"};console.log("Send message",M),t(F=>[...F,M]),C.emit("admake/chat/message",M)}else console.warn("Socket.IO not connected.");g("")}},A=()=>{if(C.connected){const x=Date.now(),w={id:Gt(),workspace_id:m==null?void 0:m.id,react:{rate:0},preview:"",reply:"",role:a,icon:"",type:"timeline",incoming:!1,user_id:o,username:u(),text:"Qu khch hng vui lng nh gi d n ny?",file_url:"",link:"",message_id:`tl-${E()}`,is_favourite:!1,createdAt:new Date(x),updatedAt:new Date(x),deletedAt:null,status:"sending"};console.log("Send REWARD message",C.io.opts.host,w),t(b=>[...b,w]),C.emit("admake/chat/message",w)}else console.warn("Socket.IO not connected.");g("")};return h.useRef(null),r.jsx(r.Fragment,{children:r.jsxs(T,{direction:"row",alignItems:"center",spacing:.5,p:.5,sx:{backgroundColor:"#00B4B6",position:"absolute",bottom:_?c?670:25:0,left:e-(_?c?7:25:0),width:s,zIndex:1300},children:[r.jsx(Wo,{onEnterKey:()=>O(d),ref:n,inputValue:d,setInputValue:g,setOpenPicker:p,handleSendMessage:O}),r.jsx(W,{sx:{height:48,width:48,backgroundColor:"#ccc",borderRadius:1.5},onClick:()=>O(d),children:r.jsx(T,{sx:{height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},children:r.jsx(Ue,{children:r.jsx(sn,{})})})}),_&&r.jsx(W,{sx:{height:48,width:48,backgroundColor:"#ccc",borderRadius:1.5},onClick:()=>A(),children:r.jsx(T,{sx:{height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},children:r.jsx(Ue,{children:r.jsx(Vo,{sx:{color:"orange"}})})})})]})})}),Ko=ue(r.jsx("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"})),Xo=ue(r.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),Rs=wt();function Mt(t){const e=new Date(t),s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0");return String(e.getSeconds()).padStart(2,"0"),`Ngy ${o}/${n}/${s}-${i}:${a}`}const Qo=({el:t,menu:e,onDelete:s})=>{if(!t)return;const n=he(),o=`${Rs}/${t==null?void 0:t.file_url}`,i=()=>{console.log("Download File",o);const a=document.createElement("a");a.href=o;const c=o.split("/").pop();c&&(a.download=c,document.body.appendChild(a),a.click(),document.body.removeChild(a))};return r.jsxs(T,{direction:"row",justifyContent:t.incoming?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:t.incoming?n.palette.background.default:n.palette.primary.main,borderRadius:1.5,width:"max-content"},children:r.jsx(T,{spacing:2,children:r.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",children:[r.jsxs(T,{p:2,spacing:3,direction:"row",alignItems:"center",sx:{backgroundColor:n.palette.background.paper,borderRadius:1},children:[r.jsx(Ko,{fontSize:"large"}),r.jsx(V,{variant:"caption",children:t.file_url}),r.jsx(Ue,{onClick:i,children:r.jsx(hn,{fontSize:"large"})})]}),r.jsx(V,{variant:"body2",sx:{color:t.incoming?"#000":"#fff"},children:Mt(t.createdAt)})]})})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},Go=({el:t,menu:e,onDelete:s})=>{if(!t)return null;const n=he();return r.jsxs(T,{direction:"row",justifyContent:t.incoming?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:t.incoming?n.palette.background.default:n.palette.primary.main,borderRadius:1.5,width:"max-content"},children:r.jsx(T,{spacing:2,children:r.jsxs(T,{p:2,spacing:3,alignItems:"start",sx:{backgroundColor:n.palette.background.paper,borderRadius:1},children:[r.jsx("img",{src:t.preview,alt:t.text,style:{maxHeight:210,borderRadius:"10px"}}),r.jsxs(T,{spacing:2,children:[r.jsx(V,{variant:"subtitle2",children:"Creating Chat App"}),r.jsx(V,{variant:"subtitle2",sx:{color:"#000"},component:Ks,to:"//https://www.youtube.com",children:"www.youtube.com"})]}),r.jsx(V,{variant:"body2",color:t.incoming?"#000":"#fff",children:t.text})]})})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},Jo=({el:t,menu:e,onDelete:s})=>{if(!t)return null;const n=he();return r.jsxs(T,{direction:"row",justifyContent:t.incoming?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:t.incoming?n.palette.background.default:n.palette.primary.main,borderRadius:1.5,width:"max-content"},children:r.jsxs(T,{spacing:2,children:[r.jsx(T,{p:2,direction:"column",spacing:3,alignItems:"center",sx:{backgroundColor:n.palette.background.paper,borderRadius:1},children:r.jsx(V,{variant:"body2",color:"#000",children:t.text})}),r.jsx(V,{variant:"body2",color:t.incoming?"#000":"#fff",children:t.reply})]})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},Zo=({el:t,menu:e,onDelete:s})=>{if(!t)return null;const n=he(),o=`${Rs}/${t.file_url}`;return r.jsxs(T,{direction:"row",justifyContent:t.incoming?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:t.incoming?n.palette.background.default:n.palette.primary.main,borderRadius:1.5,width:"max-content"},children:r.jsxs(T,{spacing:1,children:[r.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",children:r.jsx("img",{src:o,alt:t.text,style:{maxHeight:210,borderRadius:"10px",cursor:"pointer"}})}),r.jsxs(V,{variant:"body2",fontStyle:"italic",color:t.incoming?"#000":"#fff",fontSize:"0.5rem",fontWeight:300,children:[Mt(t.createdAt),"-",t.user_id]})]})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},er=({el:t,menu:e,onDelete:s})=>{if(!t)return null;he();const{userRoleId:n}=we(),o=n===-2,i=t.role===-1;console.log("TextMsg",t.username,t.role);const a=i?"#fff":t.status==="sending"?"#b0b0b0":"#00B4B6",c=i?"#000":"#fff";return r.jsxs(T,{direction:"row",justifyContent:i?"start":"end",children:[r.jsxs(W,{p:.5,sx:{backgroundColor:a,borderRadius:1.5,width:"max-content",height:"fit-content"},children:[!i&&r.jsx(T,{direction:"row",alignItems:"center",spacing:1,children:o&&r.jsxs(r.Fragment,{children:[r.jsx(Ys,{alt:t.username,src:"/images/avatar.png",sx:{width:24,height:24}}),r.jsx(V,{variant:"subtitle2",color:c,fontSize:"0.75rem",fontWeight:500,children:t.username},`DefaultMsg-${t.message_id}-Username`)]})}),r.jsx(V,{variant:"body2",p:1,color:c,fontSize:"0.75rem",fontWeight:300,children:t.text},`DefaultMsg-${t.message_id}-Text`),r.jsxs(V,{variant:"body2",fontStyle:"italic",fontSize:"0.5rem",fontWeight:300,color:c,children:[Mt(t.createdAt),"-",t.user_id]},`DefaultMsg-${t.message_id}-Time`)]},`DefaultMsg-${t.message_id}-Conatiner`),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]},`DefaultMsg-${t.message_id}-Wrapper`)},tr=({el:t,menu:e,onDelete:s})=>{var g,_;const[n,o]=h.useState(((g=t==null?void 0:t.react)==null?void 0:g.rate)??0);if(!t)return null;const{userRoleId:i}=we(),a=i===-2;h.useEffect(()=>(C.on("admake/chat/rate",m=>{console.log("Received rate:",m),o(m.rate)}),C.on("admake/chat/rate_ack",m=>{}),()=>{C.off("admake/chat/rate")}),[t]);const c=async m=>{if(console.log("Connected rates",C.connected,C.io.opts.host),C.connected){const u={workspace_id:t.workspace_id,message_id:t.message_id,rate:m};console.log("Send rate message",t.workspace_id,u),C.emit("admake/chat/rate",u);const E=h.useContext(on);if(E){const{setShowUpdateButton:O}=E;O(1)}else throw new Error("UpdateButtonContext not found")}else console.warn("Socket.IO not connected.")},l=(m,u)=>{console.log("Rating value:",u,"cho group",t.workspace_id," message_id",t.message_id),o(u),c(u)},p={1:"Qu km",2:"Km",3:"Trung bnh",4:"t",5:"Rt tt"},d=t&&t.react&&((_=t==null?void 0:t.react)==null?void 0:_.rate)!=0;return r.jsxs(T,{alignItems:"center",justifyContent:"space-between",spacing:2,py:5,sx:{backgroundColor:"rgba(0,255,255,0.25)",borderRadius:5},children:[r.jsx(V,{variant:"caption",sx:{color:"#000"},children:t.text}),(i<0||a)&&!t.is_favourite&&r.jsx(Mn,{name:"simple-controlled",value:n,max:5,onChange:l,sx:{color:"#ffff00ff"},disabled:d}),r.jsxs(T,{direction:"row",spacing:2,children:[n!==null&&r.jsx(V,{sx:{mt:1,color:"#333"},children:p[n]}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})]})},je=({el:t,onDelete:e})=>{if(!t)return null;const s=t.role<0,[n,o]=h.useState(null),i=!!n,a=p=>{o(p.currentTarget)},c=()=>{o(null)},l=()=>{c(),e&&e(t)};return r.jsxs(r.Fragment,{children:[r.jsx(Xo,{id:"basic-button",onClick:a,fontSize:"small"}),r.jsx(Xs,{id:"basic-menu",anchorEl:n,open:i,onClose:c,MenuListProps:{"aria-labelledby":"basic-button"},children:r.jsx(T,{spacing:1,px:1,children:s&&r.jsx(r.Fragment,{children:r.jsxs(Qs,{onClick:l,children:[r.jsx(Gs,{children:r.jsx(Js,{fontSize:"small"})}),"Delete"]})})})})]})},sr=({menu:t,messages:e,onDelete:s})=>{he();const n=h.useRef(null);return h.useEffect(()=>{n.current&&setTimeout(()=>{const o=n.current;o.parentElement.scrollTop=o.parentElement.scrollHeight},200)},[e]),r.jsx(W,{p:3,ref:n,children:r.jsx(T,{spacing:1,children:e&&e.map(o=>{switch(o.type){case"timeline":return r.jsx(tr,{el:o,menu:t,onDelete:s},`TimeLineMsg-${o.id}`);case"img":return r.jsx(Zo,{el:o,menu:t,onDelete:s},`MediaMsg-${o.id}`);case"doc":return r.jsx(Qo,{el:o,menu:t,onDelete:s},`DocMsg-${o.id}`);case"link":return r.jsx(Go,{el:o,menu:t,onDelete:s},`LinkMsg-${o.id}`);case"reply":return r.jsx(Jo,{el:o,menu:t,onDelete:s},`ReplyMsg-${o.id}`);default:return r.jsx(er,{el:o,menu:t,onDelete:s},`DefaultMsg-${o.message_id}`)}})})})},nr=({title:t,status:e,messages:s,setMessages:n,onDelete:o})=>{const i=h.useRef(null),{userId:a,userRoleId:c,isMobile:l}=we(),p=c===-2,[d,g]=h.useState({left:0,width:0}),_=()=>{if(i.current){const u=i.current.getBoundingClientRect();g({left:u.left,width:u.width})}};h.useEffect(()=>{if(console.log("Start_Socket",C),!C)return;const u=E=>{n(O=>O.filter(A=>A.message_id!==E.message_id))};return C.on("admake/chat/delete",u),()=>{C.off("admake/chat/delete",u)}},[C,n]),h.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[]);let m="85vw";return p?l||(m="50vw"):m="100vw",r.jsxs(T,{ref:i,sx:{width:m,height:p?"72vh":"92vh",backgroundImage:"url(/backGround.png)"},children:[r.jsx(Zs,{title:t,status:e}),r.jsx(W,{className:"scrollbar",sx:{position:"relative",ml:0,overflowY:"scroll"},children:r.jsx(sr,{messages:s,menu:p,onDelete:o})}),r.jsx(Yo,{setMessages:n,left:d.left,width:d.width})]})},Ss=tn.forwardRef(function(e,s){return r.jsx(bn,{direction:"up",ref:s,...e})}),or=({open:t,handleClose:e})=>r.jsxs(rs,{open:t,TransitionComponent:Ss,keepMounted:!0,onClose:e,"aria-describedby":"alert-dialog-slide-description",children:[r.jsx(ls,{children:"Block this contact"}),r.jsx(is,{children:r.jsx(cs,{id:"alert-dialog-slide-description",children:"Are you sure you want to block this contact?"})}),r.jsxs(as,{children:[r.jsx(rt,{onClick:e,children:"Cancel"}),r.jsx(rt,{onClick:e,children:"Yes"})]})]}),rr=({open:t,handleClose:e})=>r.jsxs(rs,{open:t,TransitionComponent:Ss,keepMounted:!0,onClose:e,"aria-describedby":"alert-dialog-slide-description",children:[r.jsx(ls,{children:"Delete this chat"}),r.jsx(is,{children:r.jsx(cs,{id:"alert-dialog-slide-description",children:"Are you sure you want to delete this chat?"})}),r.jsxs(as,{children:[r.jsx(rt,{onClick:e,children:"Cancel"}),r.jsx(rt,{onClick:e,children:"Yes"})]})]}),ir=({messages:t})=>{const{workspaceEl:e,setWorkspaceEl:s}=ht(),[n,o]=h.useState(!1),[i,a]=h.useState(!1),[c,l]=h.useState([]),[p,d]=h.useState(void 0),{userId:g,username:_,userRole:m,userIcon:u,isMobile:E}=we();h.useEffect(()=>{t&&t.length>0&&(d(t[0].workspace_id),l(t.filter(f=>f.type==="img"||f.type==="doc")))},[t,e]);const O=()=>{o(!1)},A=()=>{a(!1)},[x,w]=h.useState(0),b=(f,L)=>{w(L)},[M,F]=h.useState(null),j=f=>{F(f),window.open(`${wt()}/${f}`,"_blank")},k={fontSize:10,padding:"4px 8px",minWidth:80,marginRight:.2,borderRadius:"5px",background:"#ccc"};return r.jsxs(W,{sx:{width:E?"80vw":"30vw",p:1,ml:0,height:"fit-content",boxSizing:"border-box"},children:[r.jsxs(T,{className:"scrollbar",sx:{position:"relative",flexGrow:1},p:1,spacing:3,children:[r.jsxs(ln,{value:x,onChange:b,"aria-label":"nav tabs",children:[r.jsx(Ft,{iconPosition:"start",label:"QR",id:"tab-0","aria-controls":"tabpanel-0",sx:k}),r.jsx(Ft,{iconPosition:"start",label:"Ti liu",id:"tab-0","aria-controls":"tabpanel-0",sx:k})]}),x===0&&r.jsxs(T,{direction:"column",spacing:0,sx:{width:"100%",height:"100%",paddingBottom:2,overflowY:"auto",overflowX:"hidden"},children:[r.jsx($t,{title:"M QR cho khch hng",filename:"qrcode-admake-khachhang.png",url:`${window.location.origin}/chat/${e==null?void 0:e.id}`}),r.jsx($t,{title:"M QR cho nhn vin",filename:"qrcode-admake-nhanvien.png",url:`${window.location.origin}/chat/a${e==null?void 0:e.id}`})]}),x===1&&r.jsx(W,{sx:{p:.5,width:"100%",height:"100%",overflowY:"scroll",paddingBottom:2},children:c.length>0?c.map((f,L)=>r.jsx("img",{src:`${wt()}/${f.file_url}`,alt:f.file_url.split("_")[0],style:{width:"100%",height:"auto",marginBottom:8,cursor:"pointer"},onClick:()=>j(f.file_url)},L)):r.jsx(V,{variant:"body1",children:"Cha c ti liu"})}),r.jsx(en,{})]}),n&&r.jsx(or,{open:n,handleClose:O}),i&&r.jsx(rr,{open:i,handleClose:A})]})},dr=()=>{const{workspaceEl:t,setWorkspaceEl:e}=ht(),[s,n]=h.useState(!1),[o,i]=h.useState(!1),[a,c]=h.useState([]),[l,p]=h.useState(""),[d,g]=h.useState(""),[_,m]=h.useState(!1),[u,E]=h.useState(null),O=ss(),{userRoleId:A,workspaces:x,isMobile:w}=we(),b=A===-2;h.useEffect(()=>{console.log("Role",A)},[]),h.useEffect(()=>{t!=null&&F(t)},[t]);const M=k=>{c(f=>f.filter(L=>L.message_id!==k.message_id)),C.emit("admake/chat/delete",{message_id:k.message_id,workspace_id:k.workspace_id})},F=k=>{e&&e(k),m(!0),console.log("EL",k),fetch(`${O}/group/${k.id}/messages`).then(f=>f.json()).then(f=>{f&&f.messages&&(console.log("Data_Message",f.messages),c(f.messages),p(k.name),g(k.status),e(k)),m(!1)}).catch(f=>{console.error("Error khi ly d liu:",f),E(f),m(!1)}),n(!1)};h.useEffect(()=>{if(t)return C.on("admake/chat/message_deleted",({message_id:k})=>{c(f=>f.filter(L=>L.message_id!==k))}),C.emit("admake/chat/join_group",{workspace_id:t.id}),C.on("admake/chat/message",k=>{k.workspace_id===t.id&&c(f=>[...f,k])}),()=>{C.off("admake/chat/message"),C.off("admake/chat/message_deleted"),C.emit("admake/chat/leave_group",{group_id:t.id})}},[t]);const j=he();return r.jsx(r.Fragment,{children:r.jsxs(T,{direction:w?"column":"row",children:[b&&r.jsx(W,{sx:{backgroundColor:j.palette.mode==="light"?"#F8FAFF":"#fff",minWidth:"20vw",display:{xs:s?"block":"none",sm:"block"},boxShadow:"0px 0px 2px rgba(0,0,0,0.25)"},children:r.jsx(T,{p:0,spacing:2,children:r.jsx(T,{spacing:.5,className:"scrollbar",sx:{flexGrow:1,overflowY:"hidden"},children:r.jsx(T,{spacing:0,sx:{height:"72vh",border:"1px solid #ccc",overflowY:"auto",overflowX:"hidden"},children:x&&x.map((k,f)=>r.jsx(Vn,{workspace:k,onClick:()=>F(k),selected:(t==null?void 0:t.id)===k.id},`ChatElement-${f}`))})})})}),r.jsx(nr,{setMessages:c,messages:a,title:l,status:d||null,userId:"",username:"",onDelete:M}),b&&r.jsx(W,{sx:{marginTop:10,backgroundColor:j.palette.mode==="light"?"#F8FAFF":"#fff",width:320,boxShadow:"0px 0px 2px rgba(0,0,0,0.25)"},children:r.jsx(ir,{messages:a})})]})})};export{pr as C,dr as G,ht as u};
