import{r,I as h,_ as d,ap as g,a1 as p,aL as x,aD as i,cA as f,v as e,av as c,a2 as m,at as j,ay as v,ao as w}from"./index-DAatM5rN.js";var y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},k=function(n,t){return r.createElement(h,d({},n,{ref:t,icon:y}))},N=r.forwardRef(k);const b=()=>{const[s,n]=r.useState(!1),t=()=>n(!0),o=()=>n(!1);return{loading:s,toggle:()=>s?o():t()}},L=()=>{const{loading:s,toggle:n}=b(),t=g(),{login:o}=p(),{mutate:u}=x({mutationFn:async a=>{const l={...a,username:a.username};return f.login(l)},onError:a=>{i.error({message:"Đăng nhập thất bại",description:a instanceof Error?a.message:"Đã xảy ra lỗi khi đăng nhập"})},onSuccess:async a=>{t.clear();try{await o({username:a.username,password:""})}catch{i.error({message:"Lỗi cập nhật trạng thái người dùng"})}i.success({message:"Đăng nhập thành công",description:"Chào mừng bạn quay trở lại!"}),window.location.href="/dashboard"},onMutate:n,onSettled:n});return e.jsxs(c,{name:"login-form",className:"login-form max-w-sm w-full mx-auto mt-10 min-w-[300px]",onFinish:u,layout:"vertical",children:[e.jsx(c.Item,{label:"Tên đăng nhập",name:"username",rules:[{required:!0,message:"Vui lòng nhập tên đăng nhập!"}],children:e.jsx(m,{prefix:e.jsx(j,{}),placeholder:"Nhập tên đăng nhập"})}),e.jsx(c.Item,{label:"Mật khẩu",name:"password",rules:[{required:!0,message:"Vui lòng nhập mật khẩu!"}],children:e.jsx(m.Password,{prefix:e.jsx(N,{}),placeholder:"Nhập mật khẩu"})}),e.jsx(c.Item,{children:e.jsx(v,{type:"primary",htmlType:"submit",className:"w-full",loading:s,children:s?"Đang đăng nhập...":"Đăng nhập"})})]})},M=()=>{const s=w();return r.useEffect(()=>{sessionStorage.getItem("accessToken")?s("/dashboard",{replace:!0}):sessionStorage.removeItem("accessToken")},[s]),e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-sm min-w-[400px]",children:[e.jsxs("div",{className:"flex items-center justify-center pb-5",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:"/logo.jpg",alt:"logo",className:"w-13 h-13"})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:"/ADMAKE.svg",alt:"ADMAKE",className:"h-8"})})]}),e.jsx(L,{})]})})})};export{M as Component};
