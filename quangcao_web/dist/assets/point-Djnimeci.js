import{r as a,s as e,A as U,q,V as Le,X as K,v as I,Y as te,Z as Ie,R as Y,$ as fe,S as M,p as xe,a0 as pe,a1 as _e,a2 as Ne,t as le,Q as ze,z as Ue,E as He,G as Ye,H as Je,J as Ke,K as Ve,L as Ge,U as qe,P as Xe,M as Qe,O as Ze}from"./index-DNMvp0xH.js";import{a as V,M as Ee,b as et}from"./TitlePanel-JyalwT5X.js";import{B as P,T as G}from"./Send-BKvTbmeN.js";import{T as tt,a as nt,b as de,c as $,d as ot}from"./TableRow-FMhcyikg.js";import{T as st,C as he}from"./TableHead-D68CMd7v.js";import{g as at,J as rt}from"./Managerment-CvEOlHUy.js";import{J as ue,L as je,A as ye,D as ee}from"./JobAsset-CVJxsk5C.js";import{I as it}from"./index-C7VIqwt4.js";import"./useUpdateButtonTask-C0WyZmDf.js";import{T as ct,a as ge}from"./Tabs-DfnhsGrg.js";import{S as lt}from"./SalaryBoard-D9kHLyyj.js";const dt=()=>new Date().toLocaleString("vi-VN",{weekday:"long",year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),ht=()=>{const[t,o]=a.useState(new Date);return a.useEffect(()=>{const n=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(n)},[]),e.jsx(V,{children:e.jsxs(U,{variant:"body1",children:[dt()," "]})})},ut=[{key:"morning",label:"Sáng"},{key:"noon",label:"Chiều"},{key:"evening",label:"Tối"}];function gt(){const t=new Date,o=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${o}-${n}-${s}`}function mt({workpoint:t,fetchWorkpoint:o}){const n={maxHeight:15,fontSize:14,fontWeight:700,whiteSpace:"nowrap",maxWidth:60},[s,S]=a.useState(!1),{userId:h,userLeadId:f}=q(),[u,d]=a.useState(!1),j=()=>{d(!0)},B=async()=>{d(!1),S(!0);try{const g=`${I()}/workpoint/remove/${t==null?void 0:t.user_id}/?day=${gt()}`,b=await fetch(g,{method:"PUT"});if(!b.ok)throw new Error(`Network error: ${b.status}`);const l=await b.json();return o(),l}catch(g){throw console.error("Fetch error:",g),g}};return e.jsxs(e.Fragment,{children:[t&&!s&&e.jsxs(P,{sx:{borderRadius:10,border:"1px solid orange",color:"orange",mt:.5,height:30,maxWidth:300,mb:1},onClick:j,children:[e.jsx("img",{src:"/remove-bookmark-svgrepo-com.svg",alt:"ADMAKE",style:{width:20}}),"Xóa điểm danh gần nhất"]}),e.jsx(tt,{component:Le,sx:{maxWidth:800,minHeight:250,gap:5,background:"none"},children:e.jsxs(nt,{children:[e.jsx(st,{children:e.jsxs(de,{sx:n,children:[e.jsx($,{sx:n,children:"Buổi"}),e.jsx($,{sx:n,children:"Vào"}),e.jsx($,{sx:n,children:"Ra"}),e.jsx($,{sx:n,children:"Số giờ"})]})}),e.jsx(ot,{children:t&&t.checklist&&ut.map(({key:g,label:b})=>{var m,A,W,x;let l=null;if(g==="morning"||g==="noon"||g==="evening"){const v=g;l=(m=t==null?void 0:t.checklist)==null?void 0:m[v]}return e.jsxs(de,{sx:{height:60},children:[e.jsx($,{sx:n,children:b}),e.jsx($,{sx:n,children:(A=l==null?void 0:l.in)!=null&&A.time?e.jsx(K,{sx:{background:"#00B4B6",p:1,borderRadius:2},children:new Date(l.in.time).toLocaleTimeString()}):"---"}),e.jsx($,{sx:n,children:(W=l==null?void 0:l.out)!=null&&W.time?e.jsx(K,{sx:{background:"#00B4B6",p:1,borderRadius:2},children:new Date(l.out.time).toLocaleTimeString()}):"---"}),e.jsx($,{sx:n,children:(x=l==null?void 0:l.out)!=null&&x.time&&(l==null?void 0:l.workhour)!==void 0?l.workhour.toFixed(2):"---"})]},g)})})]})}),e.jsx(Ee,{title:"Bạn có chắc muốn xóa điểm danh ?",open:u,onOk:B,onCancel:()=>d(!1)})]})}const ft=te(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"})),xt=te(e.jsx("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"})),pt=te(e.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),{TextArea:jt}=it,yt=async t=>{const o=await fetch(`${I()}/task/${t}/by_user`);if(!o.ok)throw new Error(`Error fetching tasks for user ${t}`);const n=await o.json();return console.log("taskk",n.data),n.data},St=()=>xe({mutationFn:yt}),wt=({userId:t,fullName:o,open:n,onCancel:s})=>{const[S,h]=a.useState("task"),{mutate:f,data:u,isPending:d,isError:j,error:B}=St(),{isMobile:g,notifyAdmin:b,generateDatetimeId:l}=q(),{taskDetail:m,setTaskDetail:A}=Ie(),W=()=>{const c={id:l(),user_id:t,type:"task",description:m==null?void 0:m.workspace_id,text:`<${m==null?void 0:m.workspace}/${m==null?void 0:m.title}> hoàn thành. Vui lòng chuyển trạng thái !`,target:`/dashboard/work-tables/${m==null?void 0:m.workspace_id}`};console.log("Note",c),b(c)};a.useEffect(()=>{t&&f(t)},[]);const[x,v]=Y.useState(1),_=1;new Date().setHours(0,0,0,0);const p=a.useMemo(()=>u?u.filter(c=>{if(!c.end_time)return!0;const T=new Date(c.end_time.toString());T.setHours(0,0,0,0);const J=new Date;return J.setHours(0,0,0,0),!(T<J||c.status==="REWARD")}):[],[u]),C=p.length>0?p.slice((x-1)*_,x*_):[],O=p.length>0?Math.ceil(p.length/_):1;a.useEffect(()=>{p.length>0&&A(p[x-1]||p[0])},[x,p]);const X={color:"#fff",padding:10,paddingLeft:30,paddingRight:30,backgroundColor:"#00B5B4",whiteSpace:"nowrap",borderRadius:10};return e.jsx(fe,{open:n,onCancel:s,footer:null,children:e.jsxs(V,{children:[e.jsxs("div",{style:{marginTop:0,display:"flex",justifyContent:"center",alignItems:"center",gap:16},children:[e.jsx("button",{onClick:()=>v(c=>Math.max(c-1,1)),disabled:x===1,children:e.jsx(xt,{fontSize:"small"})}),e.jsxs("span",{children:["Trang ",x," / ",O]}),e.jsx("button",{onClick:()=>v(c=>Math.min(c+1,O)),disabled:x===O,children:e.jsx(pt,{fontSize:"small"})})]}),e.jsx(M,{spacing:5,py:2,alignItems:"flex-start",justifyContent:"flex-start",style:{boxSizing:"border-box"},children:C.length>0?C.map(c=>e.jsxs(M,{spacing:1,style:{background:"#ddd",padding:10,borderRadius:20,width:g?340:""},children:[e.jsxs(M,{direction:"row",spacing:1,children:[e.jsxs(P,{style:X,onClick:W,children:[e.jsx(ft,{}),at((c==null?void 0:c.status)??"")]}),c.workspace&&e.jsxs(M,{direction:"column",children:[e.jsx(U,{style:{marginTop:8,fontStyle:"italic",color:"#00B5B4",fontSize:10,fontWeight:500},children:c==null?void 0:c.workspace}),e.jsx(U,{style:{marginTop:8,fontStyle:"italic",color:"#00B5B4",fontSize:10,fontWeight:500},children:m==null?void 0:m.title})]})]}),e.jsx(jt,{readOnly:!0,value:c==null?void 0:c.description,rows:3,showCount:!0,maxLength:1e3,placeholder:"Mô tả chi tiết về công việc cần thực hiện...",className:"!rounded-lg !border !border-gray-300 focus:!border-cyan-500 focus:!shadow-lg hover:!border-cyan-500 !transition-all !duration-200 !shadow-sm !resize-none !text-xs sm:!text-sm h-40"}),e.jsx(rt,{form:null},c.id),e.jsx(et,{activeKey:S,onChange:T=>h(T),items:[{key:"task",label:"Tài Liệu",children:e.jsx(ue,{title:"Tài liệu",type:"task",readOnly:!0})},{key:"comments",label:"Bình luận",children:e.jsx(ue,{title:"Bình luận cho mọi người",type:"comment"})}]})]},c.id)):e.jsx(U,{style:{fontStyle:"italic",textAlign:"center"},children:"Chưa có nhiệm vụ"})})]})})};function kt({value:t,onChange:o,checkedMorning:n,checkedAfternoon:s,onCheckMorning:S,onCheckAfternoon:h}){const[f,u]=a.useState(!1),d=j=>{o(j),u(!1)};return e.jsxs(je,{dateAdapter:ye,children:[e.jsx(ee,{label:"Ngày xin nghỉ",open:f,onOpen:()=>u(!0),onClose:()=>u(!1),value:t,onChange:d,enableAccessibleFieldDOMStructure:!1,format:"DD/MM/YYYY",slots:{textField:G},slotProps:{textField:{variant:"outlined",size:"small"}},disablePast:!0}),e.jsxs(M,{direction:"row",spacing:2,mt:1,children:[e.jsx(he,{checked:n,onChange:j=>S(j.target.checked)}),e.jsx("span",{style:{marginTop:10},children:"Sáng"}),e.jsx(he,{checked:s,onChange:j=>h(j.target.checked)}),e.jsx("span",{style:{marginTop:10},children:"Chiều"})]})]})}function vt({startValue:t,endValue:o,onStartChange:n,onEndChange:s}){const S=t&&o?o.startOf("day").diff(t.startOf("day"),"day")+1:0,[h,f]=a.useState(!1),[u,d]=a.useState(!1),j=g=>{n(g),f(!1)},B=g=>{s(g),d(!1)};return e.jsxs(je,{dateAdapter:ye,children:[e.jsxs(M,{direction:"column",spacing:2,children:[e.jsx(ee,{label:"Ngày bắt đầu",open:h,onOpen:()=>f(!0),onClose:()=>f(!1),value:t,onChange:j,enableAccessibleFieldDOMStructure:!1,slots:{textField:G},slotProps:{textField:{variant:"outlined",size:"small"}},disablePast:!0}),e.jsx(ee,{label:"Ngày kết thúc",open:u,onOpen:()=>d(!0),onClose:()=>d(!1),value:o,onChange:B,enableAccessibleFieldDOMStructure:!1,slots:{textField:G},slotProps:{textField:{variant:"outlined",size:"small"}},disablePast:!0,minDate:t??void 0})]}),e.jsxs("div",{style:{marginTop:12},children:["Số ngày nghỉ: ",e.jsx("strong",{children:S>0?S:0})]})]})}const bt=async t=>{const o=await fetch(`${I()}/leave/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok)throw new Error("Failed to create leave request");return o.json()},Ct=({userId:t,open:o,onCancel:n})=>{const[s,S]=a.useState("oneDay"),{notifyAdmin:h,fullName:f}=q(),[u,d]=a.useState(null),[j,B]=a.useState(!0),[g,b]=a.useState(!0),[l,m]=a.useState(""),[A,W]=a.useState(null),[x,v]=a.useState(null),_=xe({mutationFn:bt,onSuccess:()=>{h({text:"Nhân sự xin nghỉ phép",description:f??"",target:"/dashboard/workpoints"}),n()},onError:p=>{console.error("Lỗi khi tạo yêu cầu nghỉ phép:",p.message)}}),N=()=>{if(!t)return;let p=null,C=null;if(s==="oneDay"){if(!u)return;const O=u.format("YYYY-MM-DD");p=O,C=O}else{if(!A||!x)return;p=A.format("YYYY-MM-DD"),C=x.format("YYYY-MM-DD")}_.mutate({user_id:t,start_time:p,end_time:C,morning:j,noon:g,reason:l})};return e.jsx(fe,{open:o,onCancel:n,style:{padding:20},okButtonProps:{style:{display:"none"}},cancelButtonProps:{style:{display:"none"}},children:e.jsxs(M,{children:[e.jsxs(ct,{value:s,onChange:(p,C)=>S(C),"aria-label":"Chọn loại nghỉ phép",centered:!0,children:[e.jsx(ge,{label:"1 ngày",value:"oneDay"}),e.jsx(ge,{label:"nhiều ngày",value:"multiDays"})]}),e.jsxs("div",{style:{marginTop:20},children:[s==="oneDay"&&e.jsx(kt,{value:u,onChange:d,checkedMorning:j,checkedAfternoon:g,onCheckMorning:B,onCheckAfternoon:b}),s==="multiDays"&&e.jsx(vt,{startValue:A,endValue:x,onStartChange:W,onEndChange:v})]}),e.jsx(G,{label:"Lý do xin nghỉ",value:l,onChange:p=>m(p.target.value),multiline:!0,rows:3,variant:"outlined",fullWidth:!0,margin:"normal",placeholder:"Nhập lý do xin nghỉ..."}),e.jsx(P,{fullWidth:!0,style:{marginTop:20,borderRadius:10,backgroundColor:"#00B4B6",color:"#fff"},onClick:N,disabled:s==="oneDay"&&!u||s==="multiDays"&&(!A||!x),children:"Tạo yêu cầu nghỉ phép"})]})})};function me(t,o){const n=t.getContext("2d");if(!n)return;const s=t.height/1080,S=t.height;n.fillStyle="red",n.font=`${s*150}px Oswald`;const h=s*50,f=S-s*200;n.fillText((o==null?void 0:o[1])||"",h,f),n.font=`${s*50}px Poppins`,n.fillStyle="white",n.fillText((o==null?void 0:o[0])||"",h,f+s*80),n.font=`${s*20}px Arial`,n.fillStyle="#333",n.fillText((o==null?void 0:o[2])||"",h+s*400,f+s*80),n.fillText((o==null?void 0:o[3])||"",h+s*600,f+s*80)}const Tt=({userEl:t})=>{const o=a.useRef(null),n=a.useRef(null),[s,S]=a.useState({latitude:null,longitude:null}),[h,f]=a.useState(null),[u,d]=a.useState("environment"),[j,B]=a.useState(null),[g,b]=a.useState(null),[l,m]=a.useState(""),[A,W]=a.useState(""),[x,v]=a.useState(1),[_,N]=a.useState(!1),[p,C]=a.useState(null),[O,X]=a.useState(!0),[c,T]=a.useState(null),[J,Q]=a.useState((t==null?void 0:t.role)&&(t==null?void 0:t.role_id)>100),[Se,ne]=a.useState(!1),[we,oe]=a.useState(!1),{workpointEl:ke,fetchWorkpointEl:ve}=pe(),[be,se]=a.useState(!1),{userLeadId:Ce,setUserLeadId:Te,setUserId:De}=q();a.useEffect(()=>{console.log("UserEL",t),t&&t!=null&&t.id&&(Ce===0&&Te(t.lead_id),ve(t.id),De(t==null?void 0:t.id))},[t]);const Me=()=>{se(!1)},ae=_e();a.useEffect(()=>{const r=window.location.href;if(r.includes("?zarsrc")){const i=r.split("?zarsrc")[0];ae.pathname+ae.search!==new URL(i).pathname+new URL(i).search&&(window.location.href=i)}},[]);function Z(){fetch(`${I()}/workpoint/today/${t==null?void 0:t.id}`).then(r=>{if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);return r.json()}).then(r=>{C(r),console.log(r),T(null)}).catch(r=>{T(r.message),C(null)}).finally(()=>{X(!1)})}a.useEffect(()=>{navigator.mediaDevices.enumerateDevices().then(i=>{const D=i.filter(y=>y.kind==="videoinput");oe(D.length>0)}).catch(()=>oe(!1));const r=JSON.parse(localStorage.getItem("Admake-User-Access")||"{}");console.log(r.user_id,r.username),Z()},[]),a.useEffect(()=>((async()=>{try{h&&h.getTracks().forEach(D=>D.stop());const i=await navigator.mediaDevices.getUserMedia({video:{facingMode:u}});f(i),o.current&&(o.current.srcObject=i)}catch(i){T("Lỗi truy cập camera: "+i.message)}})(),()=>{h&&h.getTracks().forEach(i=>i.stop())}),[u,x]);const re=()=>{if(!navigator.geolocation){T("Trình duyệt không hỗ trợ định vị GPS");return}navigator.geolocation.getCurrentPosition(r=>{S({latitude:r.coords.latitude,longitude:r.coords.longitude}),m(`Vị trí: ${r.coords.latitude.toFixed(6)}, ${r.coords.longitude.toFixed(6)}`),T(null)},r=>T("Lỗi lấy vị trí:"+r.message),{enableHighAccuracy:!0})},ie=()=>{var y,k;const r=new Date,i=r.toLocaleDateString(),D=r.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return[i,D,((y=s.latitude)==null?void 0:y.toString())??"-",((k=s.longitude)==null?void 0:k.toString())??"-"]},Be=()=>{const r=o.current,i=n.current;if(!we||!i||!r){console.log("Không có camera, tạo canvas đen 480x640");const y=n.current,k=480,F=640;y.width=k,y.height=F;const R=y.getContext("2d");if(!R)return;R.fillStyle="black",R.fillRect(0,0,k,F),me(y,ie()),y.toBlob(z=>{B(z),z&&(console.log("Tạo url từ blob để hiển thị hoặc gửi đi!"),b(URL.createObjectURL(z)))},"image/jpeg",.95),N(!0),re(),v(2);return}if(!i)return;i.width=r.videoWidth,i.height=r.videoHeight;const D=i.getContext("2d");D&&(D.drawImage(r,0,0,i.width,i.height),me(i,ie()),i.toBlob(y=>{B(y),y&&b(URL.createObjectURL(y))},"image/jpeg",.95),N(!0),re(),v(2))};async function Ae(r,i,D){const y=`${I()}/workpoint/check/${t==null?void 0:t.id}/`;try{const k=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({img:r,lat:i,long:D})});if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);const F=await k.json();return console.log("Response data:",F),F}catch(k){throw console.error("Fetch error:",k),k}}const Re=()=>{v(1),N(!1)},Pe=async()=>{var z,ce;if(console.log("handleSend",j),!j)return;let r="0",i="0";const k=(w=>{const L=E=>E<10?"0"+E:E;return w.getFullYear().toString()+L(w.getMonth()+1)+L(w.getDate())+"_"+L(w.getHours())+L(w.getMinutes())+L(w.getSeconds())})(new Date);r=s.latitude?s.latitude.toFixed(6):"-",i=s.longitude?s.longitude.toFixed(6):"-";const F=`workpoint_${t==null?void 0:t.id}_${k}_${r}_${i}.jpg`,R=new FormData;R.append("latitude",((z=s.latitude)==null?void 0:z.toString())??""),R.append("longitude",((ce=s.longitude)==null?void 0:ce.toString())??""),R.append("time",k),R.append("file",j,F),fetch(`${I()}/message/upload`,{method:"POST",body:R}).then(w=>{if(!w.ok)throw new Error(`HTTP error! status: ${w.status}`);return w.json()}).then(w=>{console.log(w.data.file_url,w.data.link);const L=w.data.file_url;Ae(L,r,i),setTimeout(()=>{le.success({message:"Đã gửi thành công!"}),v(1),Q(!0),Z()},1e3)}).catch(w=>{le.error({message:"Lỗi upload ảnh: "+w.message})}),B(null)},$e=()=>{Q(!1),v(1)},We=()=>{ne(!1),v(1)},Oe=()=>{Q(!0)},Fe=()=>{ne(!0)},H=(t==null?void 0:t.role_id)&&(t==null?void 0:t.role_id)>100;return e.jsxs(M,{p:1,height:"100vh",spacing:1,children:[e.jsxs(M,{direction:"row",spacing:0,style:{width:"90vw",marginLeft:10},children:[e.jsx(Ne,{}),e.jsx(K,{style:{width:"50vw",fontWeight:500,marginTop:10,marginLeft:20},children:t==null?void 0:t.fullName})]}),x===1&&e.jsx(e.Fragment,{children:e.jsxs(V,{children:[!H&&e.jsxs(e.Fragment,{children:[e.jsx(ht,{}),e.jsxs(P,{variant:"contained",sx:{backgroundColor:"orange",borderRadius:20,mt:1,height:50,maxWidth:300,mb:1},onClick:Be,children:[e.jsx("img",{src:"/alarm-svgrepo-com.svg",alt:"ADMAKE",style:{width:40}}),"Điểm danh nhé !"]}),e.jsx(mt,{workpoint:p,fetchWorkpoint:Z})]}),e.jsxs(M,{direction:"row",spacing:1,p:1,children:[!H&&e.jsx(e.Fragment,{children:e.jsxs(P,{variant:"contained",sx:{borderRadius:40,backgroundColor:"#00B4B6",fontSize:10,whiteSpace:"nowrap",mt:1,height:50,maxWidth:300,mb:1},onClick:Fe,children:[e.jsx("img",{src:"/holiday-island-tourism-svgrepo-com.svg",alt:"ADMAKE",style:{width:32}}),"Nghỉ phép"]})}),e.jsxs(P,{variant:"contained",sx:{borderRadius:40,backgroundColor:"#00B4B6",fontSize:10,textAlign:"left",whiteSpace:"nowrap",mt:1,height:50,maxWidth:300,mb:1},onClick:Oe,children:[e.jsx("img",{src:"/task-done-svgrepo-com.svg",alt:"ADMAKE",style:{width:32}}),"Nhiệm vụ"]}),!H&&e.jsxs(P,{sx:{borderRadius:40,color:"#fff",fontSize:10,backgroundColor:"#00B4B6",textAlign:"left",whiteSpace:"nowrap",mt:1,height:50,maxWidth:300,mb:1},onClick:()=>se(!0),children:[e.jsx("img",{src:"/pay-svgrepo-com.svg",alt:"ADMAKE",style:{width:32}}),"Bảng lương"]})]}),!H&&e.jsx("video",{ref:o,width:"100%",height:"auto",autoPlay:!0,playsInline:!0,style:{borderRadius:8,backgroundColor:"#000",width:"100%",maxWidth:400}})]})}),x===2&&e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsxs(K,{sx:{textAlign:"center",mt:1},children:[g&&e.jsx("img",{src:g,alt:"Ảnh đã chụp",style:{maxWidth:"100%",borderRadius:8,height:"60vh"}}),s.latitude&&s.longitude&&e.jsx(U,{sx:{mt:1},children:l})]}),c&&e.jsx(U,{color:"error",sx:{mt:1},children:c})]}),e.jsxs(M,{spacing:2,direction:"row",sx:{position:"fixed",bottom:50,left:"50%",transform:"translateX(-50%)"},children:[e.jsx(P,{onClick:Pe,variant:"contained",sx:{backgroundColor:"#00B4B6"},children:"Gửi"}),e.jsx(P,{onClick:Re,children:"Chụp lại"})]})]}),e.jsx("canvas",{ref:n,style:{display:"none"}}),e.jsx(wt,{open:J,userId:t==null?void 0:t.id,fullName:t==null?void 0:t.fullName,onCancel:$e}),!H&&e.jsx(Ct,{open:Se,userId:t==null?void 0:t.id,onCancel:We}),e.jsx(lt,{selectedRecord:ke,modalVisible:be,handleOk:Me})]})},Dt=()=>{const{id:t}=ze(),{workpointEl:o}=pe(),[n,s]=Y.useState(null),[S,h]=Y.useState(!1),[f,u]=Y.useState(!0);return Y.useEffect(()=>{t&&fetch(`${I()}/workpoint/check-access/${t}`).then(d=>{if(d.status===401||d.status===403)throw window.location.href="/login",new Error("Unauthorized");return d.json()}).then(d=>{console.log(d),d.valid?(h(!0),s(d.data),localStorage.setItem("Admake-User-Access",JSON.stringify({user_id:d.data.id,username:d.data.fullName}))):(h(!1),window.location.href="/login"),u(!1)}).catch(()=>{h(!1),u(!1)})},[t]),f?e.jsx("div",{children:"Loading...Workpoint"}):S?e.jsx(Tt,{userEl:n}):e.jsx("div",{children:"Access denied or invalid token"})},Mt={path:"/",element:e.jsx(Ye,{children:e.jsx(Je,{children:e.jsx(Ke,{children:e.jsx(Ve,{})})})}),errorElement:e.jsx(He,{}),children:[{path:"/point/:id/",element:e.jsx(Dt,{}),title:"Workpoint",ignoreInMenu:!0}]},Bt=Ue([Mt],{});Ge.createRoot(document.getElementById("root")).render(e.jsx(qe,{children:e.jsx(Xe,{children:e.jsx(Qe,{fallbackElement:e.jsx(Ze,{}),future:{v7_startTransition:!0},router:Bt})})}));
