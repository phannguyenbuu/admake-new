import{r as a,Z as P,q as R,s,v as U}from"./index-CC-dsR2w.js";import{T as D,c as E}from"./data-CLMmGdm5.js";import{S as L}from"./SalaryBoard-C7NtbpXF.js";import{U as F}from"./dashboard-n6EA6Tqm.js";import{S as N}from"./TitlePanel-BIg70oZi.js";import"./index-Czogar2Y.js";import"./index-CT_HbENb.js";import"./JobAsset-Dzx5qRxS.js";import"./Send-DzM2kTxH.js";import"./QRCode-BV0PN2Jx.js";import"./Tabs-AN1c8nJx.js";import"./TableRow-DOZIULxC.js";import"./auth.service-B3q1VF4-.js";const K=()=>{const[o,p]=a.useState({page:1,limit:10,search:"",month:new Date().getMonth()}),{setTaskDetail:f}=P(),[S,x]=a.useState([]),[w,h]=a.useState(!1),[M,j]=a.useState(0),[u,d]=a.useState(!1),[k,g]=a.useState(null),{userLeadId:y,canViewPermission:r}=R(),C=(()=>{const t=[],e=new Date,i=e.getFullYear(),m=e.getMonth();for(let n=2025;n<=i;n++){const l=n===2025?10:0,O=n===i?m:11;for(let c=l;c<=O;c++)t.push({value:c,label:`Tháng ${c+1}/${n}`})}return t})(),T=t=>{g(t),d(!0)},b=()=>{d(!1),g(null)},v=t=>{p({...o,page:1,month:t})},$=async()=>{const{page:t,limit:e,search:i,month:m}=o;h(!0);try{const l=await(await fetch(`${U()}/workpoint/page?`+new URLSearchParams({lead:y.toString(),page:String(t),limit:String(e),search:i,month:String(m)}))).json();x(l.data),j(l.pagination.total)}catch(n){console.error("Failed to fetch users",n)}finally{h(!1)}};return a.useEffect(()=>{$()},[o]),a.useEffect(()=>{console.log("canViewPermission",r),f(null)},[]),r!=null&&r.view_workpoint?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"min-h-screen p-2 w-full",children:[s.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[s.jsx("label",{className:"text-sm font-medium",children:"Chọn tháng:"}),s.jsx(N,{value:o.month,onChange:v,style:{width:200},options:C})]}),s.jsx(D,{columns:E(T,o.month),dataSource:S,loading:w,pagination:{pageSize:o.limit,current:o.page,total:M,onChange:(t,e)=>{p({...o,page:t,limit:e})},showSizeChanger:!0,showTotal:(t,e)=>`${e[0]}-${e[1]} của ${t} nhân sự`,style:{paddingRight:"15px"},locale:{items_per_page:"/ Trang"}}})]}),u&&s.jsx(L,{selectedRecord:k,modalVisible:u,handleOk:b})]}):s.jsx(F,{})};export{K as default};
