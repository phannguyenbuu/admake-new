import{b$ as it,c0 as at,r as u,c1 as Ue,j as r,c2 as te,c3 as ne,c4 as He,T as F,c5 as Gt,c6 as ue,c7 as Is,c8 as St,c9 as Jt,ca as Ds,cb as Zt,cc as Pt,cd as Fs,ce as we,cf as $s,cg as ge,ch as Vs,n as pe,bH as Et,ci as es,cj as le,ck as zs,cl as ot,cm as Us,cn as Ke,co as It,cp as Hs,cq as qs,m as W,S as C,cr as Ws,u as he,cs as Ys,ct as Ks,cu as wt,bT as ze,cv as Xs,cw as Qs,cx as Gs,cy as Js,s as mt,a as ts,cz as Zs,cA as en,k as tn}from"./index-DNmsICSd.js";import{D as sn,g as nn,u as ss,v as on,P as ns,S as rn,I as Dt,T as an,a as os,b as rs,c as is,B as rt}from"./Send-BsRJR_U0.js";import{D as cn,Q as Ft}from"./QRCode-DNPJqLp0.js";import{U as ln}from"./useUpdateButtonTask-5R4D_yu9.js";import{T as hn,a as $t}from"./Tabs-K7YGc8rz.js";function un(t){return it("MuiDialogContentText",t)}at("MuiDialogContentText",["root"]);const pn=t=>{const{classes:e}=t,n=He({root:["root"]},un,e);return{...e,...n}},dn=te(F,{shouldForwardProp:t=>Gt(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),as=u.forwardRef(function(e,s){const n=Ue({props:e,name:"MuiDialogContentText"}),{children:o,className:i,...a}=n,c=pn(a);return r.jsx(dn,{component:"p",variant:"body1",color:"textSecondary",ref:s,ownerState:a,className:ne(c.root,i),...n,classes:c})}),fn=t=>{const{classes:e}=t;return He({root:["root"]},nn,e)},mn=te(F,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),cs=u.forwardRef(function(e,s){const n=Ue({props:e,name:"MuiDialogTitle"}),{className:o,id:i,...a}=n,c=n,h=fn(c),{titleId:p=i}=u.useContext(sn);return r.jsx(mn,{component:"h2",className:ne(h.root,o),ownerState:c,ref:s,variant:"h6",id:i??p,...a})});function gn(t,e,s){const n=e.getBoundingClientRect(),o=s&&s.getBoundingClientRect(),i=Zt(e);let a;if(e.fakeTransform)a=e.fakeTransform;else{const p=i.getComputedStyle(e);a=p.getPropertyValue("-webkit-transform")||p.getPropertyValue("transform")}let c=0,h=0;if(a&&a!=="none"&&typeof a=="string"){const p=a.split("(")[1].split(")")[0].split(",");c=parseInt(p[4],10),h=parseInt(p[5],10)}return t==="left"?o?`translateX(${o.right+c-n.left}px)`:`translateX(${i.innerWidth+c-n.left}px)`:t==="right"?o?`translateX(-${n.right-o.left-c}px)`:`translateX(-${n.left+n.width-c}px)`:t==="up"?o?`translateY(${o.bottom+h-n.top}px)`:`translateY(${i.innerHeight+h-n.top}px)`:o?`translateY(-${n.top-o.top+n.height-h}px)`:`translateY(-${n.top+n.height-h}px)`}function yn(t){return typeof t=="function"?t():t}function Xe(t,e,s){const n=yn(s),o=gn(t,e,n);o&&(e.style.webkitTransform=o,e.style.transform=o)}const bn=u.forwardRef(function(e,s){const n=ue(),o={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:c=!0,children:h,container:p,direction:d="down",easing:m=o,in:l,onEnter:j,onEntered:_,onEntering:S,onExit:y,onExited:b,onExiting:E,style:T,timeout:A=i,TransitionComponent:P=Is,...Y}=e,x=u.useRef(null),R=St(Jt(h),x,s),I=f=>B=>{f&&(B===void 0?f(x.current):f(x.current,B))},z=I((f,B)=>{Xe(d,f,p),Fs(f),j&&j(f,B)}),$=I((f,B)=>{const K=Pt({timeout:A,style:T,easing:m},{mode:"enter"});f.style.webkitTransition=n.transitions.create("-webkit-transform",{...K}),f.style.transition=n.transitions.create("transform",{...K}),f.style.webkitTransform="none",f.style.transform="none",S&&S(f,B)}),de=I(_),H=I(E),se=I(f=>{const B=Pt({timeout:A,style:T,easing:m},{mode:"exit"});f.style.webkitTransition=n.transitions.create("-webkit-transform",B),f.style.transition=n.transitions.create("transform",B),Xe(d,f,p),y&&y(f)}),be=I(f=>{f.style.webkitTransition="",f.style.transition="",b&&b(f)}),V=f=>{a&&a(x.current,f)},D=u.useCallback(()=>{x.current&&Xe(d,x.current,p)},[d,p]);return u.useEffect(()=>{if(l||d==="down"||d==="right")return;const f=Ds(()=>{x.current&&Xe(d,x.current,p)}),B=Zt(x.current);return B.addEventListener("resize",f),()=>{f.clear(),B.removeEventListener("resize",f)}},[d,l,p]),u.useEffect(()=>{l||D()},[l,D]),r.jsx(P,{nodeRef:x,onEnter:z,onEntered:de,onEntering:$,onExit:se,onExited:be,onExiting:H,addEndListener:V,appear:c,in:l,timeout:A,...Y,children:(f,{ownerState:B,...K})=>u.cloneElement(h,{ref:R,style:{visibility:f==="exited"&&!l?"hidden":void 0,...T,...h.props.style},...K})})});function xn(t){return it("MuiFab",t)}const Vt=at("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),wn=t=>{const{color:e,variant:s,classes:n,size:o}=t,i={root:["root",s,`size${we(o)}`,e==="inherit"?"colorInherit":e]},a=He(i,xn,n);return{...n,...a}},vn=te($s,{name:"MuiFab",slot:"Root",shouldForwardProp:t=>Gt(t)||t==="classes",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.root,e[s.variant],e[`size${we(s.size)}`],s.color==="inherit"&&e.colorInherit,e[we(s.size)],e[s.color]]}})(ge(({theme:t})=>{var e,s;return{...t.typography.button,minHeight:36,transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(t.vars||t).zIndex.fab,boxShadow:(t.vars||t).shadows[6],"&:active":{boxShadow:(t.vars||t).shadows[12]},color:t.vars?t.vars.palette.grey[900]:(s=(e=t.palette).getContrastText)==null?void 0:s.call(e,t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],"&:hover":{backgroundColor:(t.vars||t).palette.grey.A100,"@media (hover: none)":{backgroundColor:(t.vars||t).palette.grey[300]},textDecoration:"none"},[`&.${Vt.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),ge(({theme:t})=>({variants:[...Object.entries(t.palette).filter(Vs(["dark","contrastText"])).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].contrastText,backgroundColor:(t.vars||t).palette[e].main,"&:hover":{backgroundColor:(t.vars||t).palette[e].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e].main}}}}))]})),ge(({theme:t})=>({[`&.${Vt.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}))),zt=u.forwardRef(function(e,s){const n=Ue({props:e,name:"MuiFab"}),{children:o,className:i,color:a="default",component:c="button",disabled:h=!1,disableFocusRipple:p=!1,focusVisibleClassName:d,size:m="large",variant:l="circular",...j}=n,_={...n,color:a,component:c,disabled:h,disableFocusRipple:p,size:m,variant:l},S=wn(_);return r.jsx(vn,{className:ne(S.root,i),component:c,disabled:h,focusRipple:!p,focusVisibleClassName:ne(S.focusVisible,d),ownerState:_,ref:s,...j,classes:S,children:o})}),_n=pe(r.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),kn=pe(r.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}));function Cn(t){return it("MuiRating",t)}const De=at("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]);function Tn(t){const e=t.toString().split(".")[1];return e?e.length:0}function gt(t,e){if(t==null)return t;const s=Math.round(t/e)*e;return Number(s.toFixed(Tn(e)))}const Rn=t=>{const{classes:e,size:s,readOnly:n,disabled:o,emptyValueFocused:i,focusVisible:a}=t,c={root:["root",`size${we(s)}`,o&&"disabled",a&&"focusVisible",n&&"readOnly"],label:["label","pristine"],labelEmptyValue:[i&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return He(c,Cn,e)},Sn=te("span",{name:"MuiRating",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[{[`& .${De.visuallyHidden}`]:e.visuallyHidden},e.root,e[`size${we(s.size)}`],s.readOnly&&e.readOnly]}})(ge(({theme:t})=>({display:"inline-flex",position:"relative",fontSize:t.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${De.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${De.focusVisible} .${De.iconActive}`]:{outline:"1px solid #999"},[`& .${De.visuallyHidden}`]:on,variants:[{props:{size:"small"},style:{fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:t.typography.pxToRem(30)}},{props:({ownerState:e})=>e.readOnly,style:{pointerEvents:"none"}}]}))),ls=te("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:t},e)=>[e.label,t.emptyValueFocused&&e.labelEmptyValueActive]})({cursor:"inherit",variants:[{props:({ownerState:t})=>t.emptyValueFocused,style:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}}]}),En=te("span",{name:"MuiRating",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.icon,s.iconEmpty&&e.iconEmpty,s.iconFilled&&e.iconFilled,s.iconHover&&e.iconHover,s.iconFocus&&e.iconFocus,s.iconActive&&e.iconActive]}})(ge(({theme:t})=>({display:"flex",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),pointerEvents:"none",variants:[{props:({ownerState:e})=>e.iconActive,style:{transform:"scale(1.2)"}},{props:({ownerState:e})=>e.iconEmpty,style:{color:(t.vars||t).palette.action.disabled}}]}))),An=te("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:t=>zs(t)&&t!=="iconActive",overridesResolver:(t,e)=>{const{iconActive:s}=t;return[e.decimal,s&&e.iconActive]}})({position:"relative",variants:[{props:({iconActive:t})=>t,style:{transform:"scale(1.2)"}}]});function jn(t){const{value:e,...s}=t;return r.jsx("span",{...s})}function Ut(t){const{classes:e,disabled:s,emptyIcon:n,focus:o,getLabelText:i,highlightSelectedOnly:a,hover:c,icon:h,IconContainerComponent:p,isActive:d,itemValue:m,labelProps:l,name:j,onBlur:_,onChange:S,onClick:y,onFocus:b,readOnly:E,ownerState:T,ratingValue:A,ratingValueRounded:P,slots:Y={},slotProps:x={}}=t,R=a?m===A:m<=A,I=m<=c,z=m<=o,$=m===P,de=`${j}-${Et()}`,H={slots:Y,slotProps:x},[se,be]=le("icon",{elementType:En,className:ne(e.icon,R?e.iconFilled:e.iconEmpty,I&&e.iconHover,z&&e.iconFocus,d&&e.iconActive),externalForwardedProps:H,ownerState:{...T,iconEmpty:!R,iconFilled:R,iconHover:I,iconFocus:z,iconActive:d},additionalProps:{value:m},internalForwardedProps:{as:p}}),[V,D]=le("label",{elementType:ls,externalForwardedProps:H,ownerState:{...T,emptyValueFocused:void 0},additionalProps:{style:l==null?void 0:l.style,htmlFor:de}}),f=r.jsx(se,{...be,children:n&&!R?n:h});return E?r.jsx("span",{...l,children:f}):r.jsxs(u.Fragment,{children:[r.jsxs(V,{...D,children:[f,r.jsx("span",{className:e.visuallyHidden,children:i(m)})]}),r.jsx("input",{className:e.visuallyHidden,onFocus:b,onBlur:_,onChange:S,onClick:y,disabled:s,value:m,id:de,type:"radio",name:j,checked:$})]})}const On=r.jsx(_n,{fontSize:"inherit"}),Bn=r.jsx(kn,{fontSize:"inherit"});function Ln(t){return`${t||"0"} Star${t!==1?"s":""}`}const Mn=u.forwardRef(function(e,s){const n=Ue({name:"MuiRating",props:e}),{component:o="span",className:i,defaultValue:a=null,disabled:c=!1,emptyIcon:h=Bn,emptyLabelText:p="Empty",getLabelText:d=Ln,highlightSelectedOnly:m=!1,icon:l=On,IconContainerComponent:j=jn,max:_=5,name:S,onChange:y,onChangeActive:b,onMouseLeave:E,onMouseMove:T,precision:A=1,readOnly:P=!1,size:Y="medium",value:x,slots:R={},slotProps:I={},...z}=n,$=Et(S),[de,H]=ss({controlled:x,default:a,name:"Rating"}),se=gt(de,A),be=es(),[{hover:V,focus:D},f]=u.useState({hover:-1,focus:-1});let B=se;V!==-1&&(B=V),D!==-1&&(B=D);const[K,ve]=u.useState(!1),_e=u.useRef(),ut=St(_e,s),ke=k=>{T&&T(k);const O=_e.current,{right:M,left:Ee,width:fe}=O.getBoundingClientRect();let me;be?me=(M-k.clientX)/fe:me=(k.clientX-Ee)/fe;let q=gt(_*me+A/2,A);q=Us(q,A,_),f(ae=>ae.hover===q&&ae.focus===q?ae:{hover:q,focus:q}),ve(!1),b&&V!==q&&b(k,q)},Oe=k=>{E&&E(k);const O=-1;f({hover:O,focus:O}),b&&V!==O&&b(k,O)},Be=k=>{let O=k.target.value===""?null:parseFloat(k.target.value);V!==-1&&(O=V),H(O),y&&y(k,O)},Le=k=>{k.clientX===0&&k.clientY===0||(f({hover:-1,focus:-1}),H(null),y&&parseFloat(k.target.value)===se&&y(k,null))},Ce=k=>{ot(k.target)&&ve(!0);const O=parseFloat(k.target.value);f(M=>({hover:M.hover,focus:O}))},qe=k=>{if(V!==-1)return;ot(k.target)||ve(!1);const O=-1;f(M=>({hover:M.hover,focus:O}))},[pt,Me]=u.useState(!1),U={...n,component:o,defaultValue:a,disabled:c,emptyIcon:h,emptyLabelText:p,emptyValueFocused:pt,focusVisible:K,getLabelText:d,icon:l,IconContainerComponent:j,max:_,precision:A,readOnly:P,size:Y},X=Rn(U),ie={slots:R,slotProps:I},[Te,We]=le("root",{ref:ut,className:ne(X.root,i),elementType:Sn,externalForwardedProps:{...ie,...z,component:o},getSlotProps:k=>({...k,onMouseMove:O=>{var M;ke(O),(M=k.onMouseMove)==null||M.call(k,O)},onMouseLeave:O=>{var M;Oe(O),(M=k.onMouseLeave)==null||M.call(k,O)}}),ownerState:U,additionalProps:{role:P?"img":null,"aria-label":P?d(B):null}}),[Re,Se]=le("label",{className:ne(X.label,X.labelEmptyValue),elementType:ls,externalForwardedProps:ie,ownerState:U}),[Ne,Pe]=le("decimal",{className:X.decimal,elementType:An,externalForwardedProps:ie,ownerState:U});return r.jsxs(Te,{...We,children:[Array.from(new Array(_)).map((k,O)=>{const M=O+1,Ee={classes:X,disabled:c,emptyIcon:h,focus:D,getLabelText:d,highlightSelectedOnly:m,hover:V,icon:l,IconContainerComponent:j,name:$,onBlur:qe,onChange:Be,onClick:Le,onFocus:Ce,ratingValue:B,ratingValueRounded:se,readOnly:P,ownerState:U,slots:R,slotProps:I},fe=M===Math.ceil(B)&&(V!==-1||D!==-1);if(A<1){const me=Array.from(new Array(1/A));return u.createElement(Ne,{...Pe,key:M,className:ne(Pe.className,fe&&X.iconActive),iconActive:fe},me.map((q,ae)=>{const ce=gt(M-1+(ae+1)*A,A);return r.jsx(Ut,{...Ee,isActive:!1,itemValue:ce,labelProps:{style:me.length-1===ae?{}:{width:ce===B?`${(ae+1)*A*100}%`:"0%",overflow:"hidden",position:"absolute"}}},ce)}))}return r.jsx(Ut,{...Ee,isActive:fe,itemValue:M},M)}),!P&&!c&&r.jsxs(Re,{...Se,children:[r.jsx("input",{className:X.visuallyHidden,value:"",id:`${$}-empty`,type:"radio",name:$,checked:se==null,onFocus:()=>Me(!0),onBlur:()=>Me(!1),onChange:Be}),r.jsx("span",{className:X.visuallyHidden,children:p})]})]})});function Nn(t){return it("MuiTooltip",t)}const L=at("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function Pn(t){return Math.round(t*1e5)/1e5}const In=t=>{const{classes:e,disableInteractive:s,arrow:n,touch:o,placement:i}=t,a={popper:["popper",!s&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",o&&"touch",`tooltipPlacement${we(i.split("-")[0])}`],arrow:["arrow"]};return He(a,Nn,e)},Dn=te(ns,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.popper,!s.disableInteractive&&e.popperInteractive,s.arrow&&e.popperArrow,!s.open&&e.popperClose]}})(ge(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${L.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${L.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${L.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${L.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${L.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${L.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${L.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${L.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),Fn=te("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.tooltip,s.touch&&e.touch,s.arrow&&e.tooltipArrow,e[`tooltipPlacement${we(s.placement.split("-")[0])}`]]}})(ge(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${L.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${L.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${L.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${L.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${Pn(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${L.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${L.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${L.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${L.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${L.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${L.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${L.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${L.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${L.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${L.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),$n=te("span",{name:"MuiTooltip",slot:"Arrow"})(ge(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Qe=!1;const Ht=new Hs;let Fe={x:0,y:0};function Ge(t,e){return(s,...n)=>{e&&e(s,...n),t(s,...n)}}const qt=u.forwardRef(function(e,s){const n=Ue({props:e,name:"MuiTooltip"}),{arrow:o=!1,children:i,classes:a,components:c={},componentsProps:h={},describeChild:p=!1,disableFocusListener:d=!1,disableHoverListener:m=!1,disableInteractive:l=!1,disableTouchListener:j=!1,enterDelay:_=100,enterNextDelay:S=0,enterTouchDelay:y=700,followCursor:b=!1,id:E,leaveDelay:T=0,leaveTouchDelay:A=1500,onClose:P,onOpen:Y,open:x,placement:R="bottom",PopperComponent:I,PopperProps:z={},slotProps:$={},slots:de={},title:H,TransitionComponent:se,TransitionProps:be,...V}=n,D=u.isValidElement(i)?i:r.jsx("span",{children:i}),f=ue(),B=es(),[K,ve]=u.useState(),[_e,ut]=u.useState(null),ke=u.useRef(!1),Oe=l||b,Be=Ke(),Le=Ke(),Ce=Ke(),qe=Ke(),[pt,Me]=ss({controlled:x,default:!1,name:"Tooltip",state:"open"});let U=pt;const X=Et(E),ie=u.useRef(),Te=It(()=>{ie.current!==void 0&&(document.body.style.WebkitUserSelect=ie.current,ie.current=void 0),qe.clear()});u.useEffect(()=>Te,[Te]);const We=g=>{Ht.clear(),Qe=!0,Me(!0),Y&&!U&&Y(g)},Re=It(g=>{Ht.start(800+T,()=>{Qe=!1}),Me(!1),P&&U&&P(g),Be.start(f.transitions.duration.shortest,()=>{ke.current=!1})}),Se=g=>{ke.current&&g.type!=="touchstart"||(K&&K.removeAttribute("title"),Le.clear(),Ce.clear(),_||Qe&&S?Le.start(Qe?S:_,()=>{We(g)}):We(g))},Ne=g=>{Le.clear(),Ce.start(T,()=>{Re(g)})},[,Pe]=u.useState(!1),k=g=>{ot(g.target)||(Pe(!1),Ne(g))},O=g=>{K||ve(g.currentTarget),ot(g.target)&&(Pe(!0),Se(g))},M=g=>{ke.current=!0;const Z=D.props;Z.onTouchStart&&Z.onTouchStart(g)},Ee=g=>{M(g),Ce.clear(),Be.clear(),Te(),ie.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",qe.start(y,()=>{document.body.style.WebkitUserSelect=ie.current,Se(g)})},fe=g=>{D.props.onTouchEnd&&D.props.onTouchEnd(g),Te(),Ce.start(A,()=>{Re(g)})};u.useEffect(()=>{if(!U)return;function g(Z){Z.key==="Escape"&&Re(Z)}return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[Re,U]);const me=St(Jt(D),ve,s);!H&&H!==0&&(U=!1);const q=u.useRef(),ae=g=>{const Z=D.props;Z.onMouseMove&&Z.onMouseMove(g),Fe={x:g.clientX,y:g.clientY},q.current&&q.current.update()},ce={},dt=typeof H=="string";p?(ce.title=!U&&dt&&!m?H:null,ce["aria-describedby"]=U?X:null):(ce["aria-label"]=dt?H:null,ce["aria-labelledby"]=U&&!dt?X:null);const G={...ce,...V,...D.props,className:ne(V.className,D.props.className),onTouchStart:M,ref:me,...b?{onMouseMove:ae}:{}},Ie={};j||(G.onTouchStart=Ee,G.onTouchEnd=fe),m||(G.onMouseOver=Ge(Se,G.onMouseOver),G.onMouseLeave=Ge(Ne,G.onMouseLeave),Oe||(Ie.onMouseOver=Se,Ie.onMouseLeave=Ne)),d||(G.onFocus=Ge(O,G.onFocus),G.onBlur=Ge(k,G.onBlur),Oe||(Ie.onFocus=O,Ie.onBlur=k));const xe={...n,isRtl:B,arrow:o,disableInteractive:Oe,placement:R,PopperComponentProp:I,touch:ke.current},J=typeof $.popper=="function"?$.popper(xe):$.popper,Ss=u.useMemo(()=>{var Z,Nt;let g=[{name:"arrow",enabled:!!_e,options:{element:_e,padding:4}}];return(Z=z.popperOptions)!=null&&Z.modifiers&&(g=g.concat(z.popperOptions.modifiers)),(Nt=J==null?void 0:J.popperOptions)!=null&&Nt.modifiers&&(g=g.concat(J.popperOptions.modifiers)),{...z.popperOptions,...J==null?void 0:J.popperOptions,modifiers:g}},[_e,z.popperOptions,J==null?void 0:J.popperOptions]),ft=In(xe),Es=typeof $.transition=="function"?$.transition(xe):$.transition,Ye={slots:{popper:c.Popper,transition:c.Transition??se,tooltip:c.Tooltip,arrow:c.Arrow,...de},slotProps:{arrow:$.arrow??h.arrow,popper:{...z,...J??h.popper},tooltip:$.tooltip??h.tooltip,transition:{...be,...Es??h.transition}}},[As,js]=le("popper",{elementType:Dn,externalForwardedProps:Ye,ownerState:xe,className:ne(ft.popper,z==null?void 0:z.className)}),[Os,Bs]=le("transition",{elementType:qs,externalForwardedProps:Ye,ownerState:xe}),[Ls,Ms]=le("tooltip",{elementType:Fn,className:ft.tooltip,externalForwardedProps:Ye,ownerState:xe}),[Ns,Ps]=le("arrow",{elementType:$n,className:ft.arrow,externalForwardedProps:Ye,ownerState:xe,ref:ut});return r.jsxs(u.Fragment,{children:[u.cloneElement(D,G),r.jsx(As,{as:I??ns,placement:R,anchorEl:b?{getBoundingClientRect:()=>({top:Fe.y,left:Fe.x,right:Fe.x,bottom:Fe.y,width:0,height:0})}:K,popperRef:q,open:K?U:!1,id:X,transition:!0,...Ie,...js,popperOptions:Ss,children:({TransitionProps:g})=>r.jsx(Os,{timeout:f.transitions.duration.shorter,...g,...Bs,children:r.jsxs(Ls,{...Ms,children:[H,o?r.jsx(Ns,{...Ps}):null]})})})]})}),Vn=({workspace:t,onClick:e,selected:s})=>{const n=o=>{e(o,t)};return r.jsx(W,{onClick:n,sx:{width:"100%",backgroundColor:s?"#ccc":"#fff",cursor:"pointer"},p:2,children:r.jsx(C,{direction:"row",alignItems:"center",justifyContent:"space-between",children:r.jsx(C,{direction:"row",spacing:2,children:r.jsxs(C,{spacing:.3,children:[r.jsx(F,{variant:"subtitle2",children:t.name}),r.jsx(F,{variant:"caption",color:"#333",fontStyle:"italic",children:t.address})]})})})})},re=Object.create(null);re.open="0";re.close="1";re.ping="2";re.pong="3";re.message="4";re.upgrade="5";re.noop="6";const et=Object.create(null);Object.keys(re).forEach(t=>{et[re[t]]=t});const vt={type:"error",data:"parser error"},hs=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",us=typeof ArrayBuffer=="function",ps=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,At=({type:t,data:e},s,n)=>hs&&e instanceof Blob?s?n(e):Wt(e,n):us&&(e instanceof ArrayBuffer||ps(e))?s?n(e):Wt(new Blob([e]),n):n(re[t]+(e||"")),Wt=(t,e)=>{const s=new FileReader;return s.onload=function(){const n=s.result.split(",")[1];e("b"+(n||""))},s.readAsDataURL(t)};function Yt(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let yt;function zn(t,e){if(hs&&t.data instanceof Blob)return t.data.arrayBuffer().then(Yt).then(e);if(us&&(t.data instanceof ArrayBuffer||ps(t.data)))return e(Yt(t.data));At(t,!1,s=>{yt||(yt=new TextEncoder),e(yt.encode(s))})}const Kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ve=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<Kt.length;t++)Ve[Kt.charCodeAt(t)]=t;const Un=t=>{let e=t.length*.75,s=t.length,n,o=0,i,a,c,h;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const p=new ArrayBuffer(e),d=new Uint8Array(p);for(n=0;n<s;n+=4)i=Ve[t.charCodeAt(n)],a=Ve[t.charCodeAt(n+1)],c=Ve[t.charCodeAt(n+2)],h=Ve[t.charCodeAt(n+3)],d[o++]=i<<2|a>>4,d[o++]=(a&15)<<4|c>>2,d[o++]=(c&3)<<6|h&63;return p},Hn=typeof ArrayBuffer=="function",jt=(t,e)=>{if(typeof t!="string")return{type:"message",data:ds(t,e)};const s=t.charAt(0);return s==="b"?{type:"message",data:qn(t.substring(1),e)}:et[s]?t.length>1?{type:et[s],data:t.substring(1)}:{type:et[s]}:vt},qn=(t,e)=>{if(Hn){const s=Un(t);return ds(s,e)}else return{base64:!0,data:t}},ds=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},fs="",Wn=(t,e)=>{const s=t.length,n=new Array(s);let o=0;t.forEach((i,a)=>{At(i,!1,c=>{n[a]=c,++o===s&&e(n.join(fs))})})},Yn=(t,e)=>{const s=t.split(fs),n=[];for(let o=0;o<s.length;o++){const i=jt(s[o],e);if(n.push(i),i.type==="error")break}return n};function Kn(){return new TransformStream({transform(t,e){zn(t,s=>{const n=s.length;let o;if(n<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,n);else if(n<65536){o=new Uint8Array(3);const i=new DataView(o.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{o=new Uint8Array(9);const i=new DataView(o.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(o[0]|=128),e.enqueue(o),e.enqueue(s)})}})}let bt;function Je(t){return t.reduce((e,s)=>e+s.length,0)}function Ze(t,e){if(t[0].length===e)return t.shift();const s=new Uint8Array(e);let n=0;for(let o=0;o<e;o++)s[o]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),s}function Xn(t,e){bt||(bt=new TextDecoder);const s=[];let n=0,o=-1,i=!1;return new TransformStream({transform(a,c){for(s.push(a);;){if(n===0){if(Je(s)<1)break;const h=Ze(s,1);i=(h[0]&128)===128,o=h[0]&127,o<126?n=3:o===126?n=1:n=2}else if(n===1){if(Je(s)<2)break;const h=Ze(s,2);o=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),n=3}else if(n===2){if(Je(s)<8)break;const h=Ze(s,8),p=new DataView(h.buffer,h.byteOffset,h.length),d=p.getUint32(0);if(d>Math.pow(2,21)-1){c.enqueue(vt);break}o=d*Math.pow(2,32)+p.getUint32(4),n=3}else{if(Je(s)<o)break;const h=Ze(s,o);c.enqueue(jt(i?h:bt.decode(h),e)),n=0}if(o===0||o>t){c.enqueue(vt);break}}}})}const ms=4;function N(t){if(t)return Qn(t)}function Qn(t){for(var e in N.prototype)t[e]=N.prototype[e];return t}N.prototype.on=N.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};N.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this};N.prototype.off=N.prototype.removeListener=N.prototype.removeAllListeners=N.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+t];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,o=0;o<s.length;o++)if(n=s[o],n===e||n.fn===e){s.splice(o,1);break}return s.length===0&&delete this._callbacks["$"+t],this};N.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(s){s=s.slice(0);for(var n=0,o=s.length;n<o;++n)s[n].apply(this,e)}return this};N.prototype.emitReserved=N.prototype.emit;N.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};N.prototype.hasListeners=function(t){return!!this.listeners(t).length};const ct=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,s)=>s(e,0),Q=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Gn="arraybuffer";function gs(t,...e){return e.reduce((s,n)=>(t.hasOwnProperty(n)&&(s[n]=t[n]),s),{})}const Jn=Q.setTimeout,Zn=Q.clearTimeout;function lt(t,e){e.useNativeTimers?(t.setTimeoutFn=Jn.bind(Q),t.clearTimeoutFn=Zn.bind(Q)):(t.setTimeoutFn=Q.setTimeout.bind(Q),t.clearTimeoutFn=Q.clearTimeout.bind(Q))}const eo=1.33;function to(t){return typeof t=="string"?so(t):Math.ceil((t.byteLength||t.size)*eo)}function so(t){let e=0,s=0;for(let n=0,o=t.length;n<o;n++)e=t.charCodeAt(n),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(n++,s+=4);return s}function ys(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function no(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}function oo(t){let e={},s=t.split("&");for(let n=0,o=s.length;n<o;n++){let i=s[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class ro extends Error{constructor(e,s,n){super(e),this.description=s,this.context=n,this.type="TransportError"}}class Ot extends N{constructor(e){super(),this.writable=!1,lt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,s,n){return super.emitReserved("error",new ro(e,s,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const s=jt(e,this.socket.binaryType);this.onPacket(s)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,s={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const s=no(e);return s.length?"?"+s:""}}class io extends Ot{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const s=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||s()})),this.writable||(n++,this.once("drain",function(){--n||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const s=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};Yn(e,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Wn(e,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=ys()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(e,s)}}let bs=!1;try{bs=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ao=bs;function co(){}class lo extends io{constructor(e){if(super(e),typeof location<"u"){const s=location.protocol==="https:";let n=location.port;n||(n=s?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,s){const n=this.request({method:"POST",data:e});n.on("success",s),n.on("error",(o,i)=>{this.onError("xhr post error",o,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(s,n)=>{this.onError("xhr poll error",s,n)}),this.pollXhr=e}}class oe extends N{constructor(e,s,n){super(),this.createRequest=e,lt(this,n),this._opts=n,this._method=n.method||"GET",this._uri=s,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const s=gs(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(s);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var o;n.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=oe.requestsCount++,oe.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=co,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete oe.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}oe.requestsCount=0;oe.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Xt);else if(typeof addEventListener=="function"){const t="onpagehide"in Q?"pagehide":"unload";addEventListener(t,Xt,!1)}}function Xt(){for(let t in oe.requests)oe.requests.hasOwnProperty(t)&&oe.requests[t].abort()}const ho=(function(){const t=xs({xdomain:!1});return t&&t.responseType!==null})();class uo extends lo{constructor(e){super(e);const s=e&&e.forceBase64;this.supportsBinary=ho&&!s}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new oe(xs,this.uri(),e)}}function xs(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||ao))return new XMLHttpRequest}catch{}if(!e)try{return new Q[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ws=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class po extends Ot{get name(){return"websocket"}doOpen(){const e=this.uri(),s=this.opts.protocols,n=ws?{}:gs(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,s,n)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],o=s===e.length-1;At(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}o&&ct(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=ys()),this.supportsBinary||(s.b64=1),this.createUri(e,s)}}const xt=Q.WebSocket||Q.MozWebSocket;class fo extends po{createSocket(e,s,n){return ws?new xt(e,s,n):s?new xt(e,s):new xt(e)}doWrite(e,s){this.ws.send(s)}}class mo extends Ot{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const s=Xn(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(s).getReader(),o=Kn();o.readable.pipeTo(e.writable),this._writer=o.writable.getWriter();const i=()=>{n.read().then(({done:c,value:h})=>{c||(this.onPacket(h),i())}).catch(c=>{})};i();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let s=0;s<e.length;s++){const n=e[s],o=s===e.length-1;this._writer.write(n).then(()=>{o&&ct(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const go={websocket:fo,webtransport:mo,polling:uo},yo=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,bo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function _t(t){if(t.length>8e3)throw"URI too long";const e=t,s=t.indexOf("["),n=t.indexOf("]");s!=-1&&n!=-1&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));let o=yo.exec(t||""),i={},a=14;for(;a--;)i[bo[a]]=o[a]||"";return s!=-1&&n!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=xo(i,i.path),i.queryKey=wo(i,i.query),i}function xo(t,e){const s=/\/{2,9}/g,n=e.replace(s,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function wo(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,o,i){o&&(s[o]=i)}),s}const kt=typeof addEventListener=="function"&&typeof removeEventListener=="function",tt=[];kt&&addEventListener("offline",()=>{tt.forEach(t=>t())},!1);class ye extends N{constructor(e,s){if(super(),this.binaryType=Gn,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(s=e,e=null),e){const n=_t(e);s.hostname=n.host,s.secure=n.protocol==="https"||n.protocol==="wss",s.port=n.port,n.query&&(s.query=n.query)}else s.host&&(s.hostname=_t(s.host).host);lt(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(n=>{const o=n.prototype.name;this.transports.push(o),this._transportsByName[o]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=oo(this.opts.query)),kt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},tt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const s=Object.assign({},this.opts.query);s.EIO=ms,s.transport=e,this.id&&(s.sid=this.id);const n=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&ye.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(e);s.open(),this.setTransport(s)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",ye.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=e.data,this._onError(s);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let n=0;n<this.writeBuffer.length;n++){const o=this.writeBuffer[n].data;if(o&&(s+=to(o)),n>0&&s>this._maxPayload)return this.writeBuffer.slice(0,n);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,ct(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,s,n){return this._sendPacket("message",e,s,n),this}send(e,s,n){return this._sendPacket("message",e,s,n),this}_sendPacket(e,s,n,o){if(typeof s=="function"&&(o=s,s=void 0),typeof n=="function"&&(o=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:e,data:s,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),o&&this.once("flush",o),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),e()},n=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(ye.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),kt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=tt.indexOf(this._offlineEventListener);n!==-1&&tt.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,s),this.writeBuffer=[],this._prevBufferLen=0}}}ye.protocol=ms;class vo extends ye{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let s=this.createTransport(e),n=!1;ye.priorWebsocketSuccess=!1;const o=()=>{n||(s.send([{type:"ping",data:"probe"}]),s.once("packet",m=>{if(!n)if(m.type==="pong"&&m.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;ye.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const l=new Error("probe error");l.transport=s.name,this.emitReserved("upgradeError",l)}}))};function i(){n||(n=!0,d(),s.close(),s=null)}const a=m=>{const l=new Error("probe error: "+m);l.transport=s.name,i(),this.emitReserved("upgradeError",l)};function c(){a("transport closed")}function h(){a("socket closed")}function p(m){s&&m.name!==s.name&&i()}const d=()=>{s.removeListener("open",o),s.removeListener("error",a),s.removeListener("close",c),this.off("close",h),this.off("upgrading",p)};s.once("open",o),s.once("error",a),s.once("close",c),this.once("close",h),this.once("upgrading",p),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||s.open()},200):s.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const s=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&s.push(e[n]);return s}}let _o=class extends vo{constructor(e,s={}){const n=typeof e=="object"?e:s;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(o=>go[o]).filter(o=>!!o)),super(e,n)}};function ko(t,e="",s){let n=t;s=s||typeof location<"u"&&location,t==null&&(t=s.protocol+"//"+s.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=s.protocol+t:t=s.host+t),/^(https?|wss?):\/\//.test(t)||(typeof s<"u"?t=s.protocol+"//"+t:t="https://"+t),n=_t(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(s&&s.port===n.port?"":":"+n.port),n}const Co=typeof ArrayBuffer=="function",To=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,vs=Object.prototype.toString,Ro=typeof Blob=="function"||typeof Blob<"u"&&vs.call(Blob)==="[object BlobConstructor]",So=typeof File=="function"||typeof File<"u"&&vs.call(File)==="[object FileConstructor]";function Bt(t){return Co&&(t instanceof ArrayBuffer||To(t))||Ro&&t instanceof Blob||So&&t instanceof File}function st(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let s=0,n=t.length;s<n;s++)if(st(t[s]))return!0;return!1}if(Bt(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return st(t.toJSON(),!0);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&st(t[s]))return!0;return!1}function Eo(t){const e=[],s=t.data,n=t;return n.data=Ct(s,e),n.attachments=e.length,{packet:n,buffers:e}}function Ct(t,e){if(!t)return t;if(Bt(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}else if(Array.isArray(t)){const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=Ct(t[n],e);return s}else if(typeof t=="object"&&!(t instanceof Date)){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=Ct(t[n],e));return s}return t}function Ao(t,e){return t.data=Tt(t.data,e),delete t.attachments,t}function Tt(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=Tt(t[s],e);else if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=Tt(t[s],e));return t}const jo=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Oo=5;var w;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(w||(w={}));class Bo{constructor(e){this.replacer=e}encode(e){return(e.type===w.EVENT||e.type===w.ACK)&&st(e)?this.encodeAsBinary({type:e.type===w.EVENT?w.BINARY_EVENT:w.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let s=""+e.type;return(e.type===w.BINARY_EVENT||e.type===w.BINARY_ACK)&&(s+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(s+=e.nsp+","),e.id!=null&&(s+=e.id),e.data!=null&&(s+=JSON.stringify(e.data,this.replacer)),s}encodeAsBinary(e){const s=Eo(e),n=this.encodeAsString(s.packet),o=s.buffers;return o.unshift(n),o}}function Qt(t){return Object.prototype.toString.call(t)==="[object Object]"}class Lt extends N{constructor(e){super(),this.reviver=e}add(e){let s;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(e);const n=s.type===w.BINARY_EVENT;n||s.type===w.BINARY_ACK?(s.type=n?w.EVENT:w.ACK,this.reconstructor=new Lo(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(Bt(e)||e.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(e),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let s=0;const n={type:Number(e.charAt(0))};if(w[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===w.BINARY_EVENT||n.type===w.BINARY_ACK){const i=s+1;for(;e.charAt(++s)!=="-"&&s!=e.length;);const a=e.substring(i,s);if(a!=Number(a)||e.charAt(s)!=="-")throw new Error("Illegal attachments");n.attachments=Number(a)}if(e.charAt(s+1)==="/"){const i=s+1;for(;++s&&!(e.charAt(s)===","||s===e.length););n.nsp=e.substring(i,s)}else n.nsp="/";const o=e.charAt(s+1);if(o!==""&&Number(o)==o){const i=s+1;for(;++s;){const a=e.charAt(s);if(a==null||Number(a)!=a){--s;break}if(s===e.length)break}n.id=Number(e.substring(i,s+1))}if(e.charAt(++s)){const i=this.tryParse(e.substr(s));if(Lt.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,s){switch(e){case w.CONNECT:return Qt(s);case w.DISCONNECT:return s===void 0;case w.CONNECT_ERROR:return typeof s=="string"||Qt(s);case w.EVENT:case w.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&jo.indexOf(s[0])===-1);case w.ACK:case w.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Lo{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const s=Ao(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Mo=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Lt,Encoder:Bo,get PacketType(){return w},protocol:Oo},Symbol.toStringTag,{value:"Module"}));function ee(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const No=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class _s extends N{constructor(e,s,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=s,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ee(e,"open",this.onopen.bind(this)),ee(e,"packet",this.onpacket.bind(this)),ee(e,"error",this.onerror.bind(this)),ee(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...s){var n,o,i;if(No.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(s.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const a={type:w.EVENT,data:s};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const d=this.ids++,m=s.pop();this._registerAckCallback(d,m),a.id=d}const c=(o=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||o===void 0?void 0:o.writable,h=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(h?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(e,s){var n;const o=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(o===void 0){this.acks[e]=s;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===e&&this.sendBuffer.splice(c,1);s.call(this,new Error("operation has timed out"))},o),a=(...c)=>{this.io.clearTimeoutFn(i),s.apply(this,c)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...s){return new Promise((n,o)=>{const i=(a,c)=>a?o(a):n(c);i.withError=!0,s.push(i),this.emit(e,...s)})}_addToQueue(e){let s;typeof e[e.length-1]=="function"&&(s=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((o,...i)=>n!==this._queue[0]?void 0:(o!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(o)):(this._queue.shift(),s&&s(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!e||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:w.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case w.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case w.EVENT:case w.BINARY_EVENT:this.onevent(e);break;case w.ACK:case w.BINARY_ACK:this.onack(e);break;case w.DISCONNECT:this.ondisconnect();break;case w.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const s=e.data||[];e.id!=null&&s.push(this.ack(e.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const n of s)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const s=this;let n=!1;return function(...o){n||(n=!0,s.packet({type:w.ACK,id:e,data:o}))}}onack(e){const s=this.acks[e.id];typeof s=="function"&&(delete this.acks[e.id],s.withError&&e.data.unshift(null),s.apply(this,e.data))}onconnect(e,s){this.id=e,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:w.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const s=this._anyListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const s=this._anyOutgoingListeners;for(let n=0;n<s.length;n++)if(e===s[n])return s.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const n of s)n.apply(this,e.data)}}}function Ae(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Ae.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-s:t+s}return Math.min(t,this.max)|0};Ae.prototype.reset=function(){this.attempts=0};Ae.prototype.setMin=function(t){this.ms=t};Ae.prototype.setMax=function(t){this.max=t};Ae.prototype.setJitter=function(t){this.jitter=t};class Rt extends N{constructor(e,s){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(s=e,e=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,lt(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((n=s.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Ae({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=e;const o=s.parser||Mo;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var s;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(s=this.backoff)===null||s===void 0||s.setMin(e),this)}randomizationFactor(e){var s;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(s=this.backoff)===null||s===void 0||s.setJitter(e),this)}reconnectionDelayMax(e){var s;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(s=this.backoff)===null||s===void 0||s.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new _o(this.uri,this.opts);const s=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const o=ee(s,"open",function(){n.onopen(),e&&e()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),e?e(c):this.maybeReconnectOnOpen()},a=ee(s,"error",i);if(this._timeout!==!1){const c=this._timeout,h=this.setTimeoutFn(()=>{o(),i(new Error("timeout")),s.close()},c);this.opts.autoUnref&&h.unref(),this.subs.push(()=>{this.clearTimeoutFn(h)})}return this.subs.push(o),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ee(e,"ping",this.onping.bind(this)),ee(e,"data",this.ondata.bind(this)),ee(e,"error",this.onerror.bind(this)),ee(e,"close",this.onclose.bind(this)),ee(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(s){this.onclose("parse error",s)}}ondecoded(e){ct(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,s){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new _s(this,e,s),this.nsps[e]=n),n}_destroy(e){const s=Object.keys(this.nsps);for(const n of s)if(this.nsps[n].active)return;this._close()}_packet(e){const s=this.encoder.encode(e);for(let n=0;n<s.length;n++)this.engine.write(s[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,s){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(o=>{o?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",o)):e.onreconnect()}))},s);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const $e={};function nt(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const s=ko(t,e.path||"/socket.io"),n=s.source,o=s.id,i=s.path,a=$e[o]&&i in $e[o].nsps,c=e.forceNew||e["force new connection"]||e.multiplex===!1||a;let h;return c?h=new Rt(n,e):($e[o]||($e[o]=new Rt(n,e)),h=$e[o]),s.query&&!e.query&&(e.query=s.queryKey),h.socket(s.path,e)}Object.assign(nt,{Manager:Rt,Socket:_s,io:nt,connect:nt});const Po=Ws()||"https://admake.vn",v=nt(Po,{path:"/socket.io",autoConnect:!1,transports:["websocket"]}),Io=pe(r.jsx("path",{d:"m9.4 10.5 4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35zM21.54 9c-.92-2.92-3.15-5.26-6-6.34L11.88 9zm.26 1h-7.49l.29.5 4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2M8.54 12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 2h7.49zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 15zm11.27 0-3.9 6.76c.7.15 1.42.24 2.17.24 2.4 0 4.6-.85 6.32-2.25l-3.66-6.35z"})),Do=pe(r.jsx("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm7 7V3.5L18.5 9z"})),Fo=pe(r.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),$o=pe([r.jsx("circle",{cx:"15.5",cy:"9.5",r:"1.5"},"0"),r.jsx("circle",{cx:"8.5",cy:"9.5",r:"1.5"},"1"),r.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m0-4c-.73 0-1.38-.18-1.96-.52-.12.14-.86.98-1.01 1.15.86.55 1.87.87 2.97.87 1.11 0 2.12-.33 2.98-.88-.97-1.09-.01-.02-1.01-1.15-.59.35-1.24.53-1.97.53"},"2")]),Vo=pe(r.jsx("path",{d:"M1 21h4V9H1zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73z"})),ks=u.createContext(void 0),pr=({children:t})=>{const[e,s]=u.useState(null);return r.jsx(ks.Provider,{value:{workspaceEl:e,setWorkspaceEl:s},children:t})},ht=()=>{const t=u.useContext(ks);if(t===void 0)throw new Error("useChatGroup must be used within a ChatGroupProvider");return t},zo=pe(r.jsx("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"})),Uo=pe(r.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),Cs=wt();function Mt(t){const e=new Date(t),s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0");return String(e.getSeconds()).padStart(2,"0"),`Ngy ${o}/${n}/${s}-${i}:${a}`}const Ho=({el:t,menu:e,onDelete:s})=>{if(!t)return;const n=ue(),o=`${Cs}/${t==null?void 0:t.file_url}`,i=()=>{console.log("Download File",o);const a=document.createElement("a");a.href=o;const c=o.split("/").pop();c&&(a.download=c,document.body.appendChild(a),a.click(),document.body.removeChild(a))};return r.jsxs(C,{direction:"row",justifyContent:t.incoming?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:t.incoming?n.palette.background.default:n.palette.primary.main,borderRadius:1.5,width:"max-content"},children:r.jsx(C,{spacing:2,children:r.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",children:[r.jsxs(C,{p:2,spacing:3,direction:"row",alignItems:"center",sx:{backgroundColor:n.palette.background.paper,borderRadius:1},children:[r.jsx(zo,{fontSize:"large"}),r.jsx(F,{variant:"caption",children:t.file_url}),r.jsx(ze,{onClick:i,children:r.jsx(cn,{fontSize:"large"})})]}),r.jsx(F,{variant:"body2",sx:{color:t.incoming?"#000":"#fff"},children:Mt(t.createdAt)})]})})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},qo=({el:t,menu:e,onDelete:s})=>{if(!t)return null;const n=ue();return r.jsxs(C,{direction:"row",justifyContent:t.incoming?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:t.incoming?n.palette.background.default:n.palette.primary.main,borderRadius:1.5,width:"max-content"},children:r.jsx(C,{spacing:2,children:r.jsxs(C,{p:2,spacing:3,alignItems:"start",sx:{backgroundColor:n.palette.background.paper,borderRadius:1},children:[r.jsx("img",{src:t.preview,alt:t.text,style:{maxHeight:210,borderRadius:"10px"}}),r.jsxs(C,{spacing:2,children:[r.jsx(F,{variant:"subtitle2",children:"Creating Chat App"}),r.jsx(F,{variant:"subtitle2",sx:{color:"#000"},component:Ks,to:"//https://www.youtube.com",children:"www.youtube.com"})]}),r.jsx(F,{variant:"body2",color:t.incoming?"#000":"#fff",children:t.text})]})})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},Wo=({el:t,menu:e,onDelete:s})=>{if(!t)return null;const n=ue();return r.jsxs(C,{direction:"row",justifyContent:t.incoming?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:t.incoming?n.palette.background.default:n.palette.primary.main,borderRadius:1.5,width:"max-content"},children:r.jsxs(C,{spacing:2,children:[r.jsx(C,{p:2,direction:"column",spacing:3,alignItems:"center",sx:{backgroundColor:n.palette.background.paper,borderRadius:1},children:r.jsx(F,{variant:"body2",color:"#000",children:t.text})}),r.jsx(F,{variant:"body2",color:t.incoming?"#000":"#fff",children:t.reply})]})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},Yo=({el:t,menu:e,onDelete:s})=>{if(!t)return null;ue();const{userRoleId:n}=he(),o=t.role===-1;o||t.status;const i=`${Cs}/${t.file_url}`;return r.jsxs(C,{direction:"row",justifyContent:o?"start":"end",children:[r.jsx(W,{p:.2,sx:{backgroundColor:o?"#fff":"#00B5B4",borderRadius:1.5,width:"max-content"},children:r.jsxs(C,{spacing:1,children:[r.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",children:r.jsx("img",{src:i,alt:t.text,style:{maxHeight:210,borderRadius:"10px",cursor:"pointer"}})}),r.jsxs(F,{variant:"body2",fontStyle:"italic",color:o?"#000":"#fff",fontSize:"0.5rem",fontWeight:300,children:[Mt(t.createdAt),"-",t.user_id]})]})}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})},Ko=({el:t,menu:e,onDelete:s})=>{if(!t)return null;ue();const{userRoleId:n}=he(),o=n===-2,i=t.role===-1,a=i?"#fff":t.status==="sending"?"#b0b0b0":"#00B4B6",c=i?"#000":"#fff";return r.jsxs(C,{direction:"row",justifyContent:i?"start":"end",children:[r.jsxs(W,{p:.5,sx:{backgroundColor:a,borderRadius:1.5,width:"max-content",height:"fit-content"},children:[!i&&r.jsx(C,{direction:"row",alignItems:"center",spacing:1,children:o&&r.jsxs(r.Fragment,{children:[r.jsx(Ys,{alt:t.username,src:"/images/avatar.png",sx:{width:24,height:24}}),r.jsx(F,{variant:"subtitle2",color:c,fontSize:"0.75rem",fontWeight:500,children:t.username},`DefaultMsg-${t.message_id}-Username`)]})}),r.jsx(F,{variant:"body2",p:1,color:c,fontSize:"0.75rem",fontWeight:300,children:t.text},`DefaultMsg-${t.message_id}-Text`),r.jsxs(F,{variant:"body2",fontStyle:"italic",fontSize:"0.5rem",fontWeight:300,color:c,children:[Mt(t.createdAt),"-",t.user_id]},`DefaultMsg-${t.message_id}-Time`)]},`DefaultMsg-${t.message_id}-Conatiner`),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]},`DefaultMsg-${t.message_id}-Wrapper`)},Xo=({el:t,menu:e,onDelete:s})=>{var l,j;if(!t)return null;const{notifyAdmin:n}=he(),[o,i]=u.useState(((l=t==null?void 0:t.react)==null?void 0:l.rate)??0),{userRoleId:a}=he(),c=a===-2;u.useEffect(()=>(v.on("admake/chat/rate",_=>{console.log("Received rate:",_),i(_.rate)}),v.on("admake/chat/rate_ack",_=>{}),()=>{v.off("admake/chat/rate")}),[t]);const h=async _=>{if(v.connected){const S={workspace_id:t.workspace_id,message_id:t.message_id,rate:_};console.log("Send rate message",t.workspace_id,S),n({text:`Khch hng va chm ${_} sao`,target:`/dashboard/work-tables/${t==null?void 0:t.workspace_id}`}),v.emit("admake/chat/rate",S);const y=u.useContext(ln);if(y){const{setShowUpdateButton:b}=y;b(1)}else throw new Error("UpdateButtonContext not found")}else console.warn("Socket.IO not connected.")},p=(_,S)=>{console.log("Rating value:",S,"cho group",t.workspace_id," message_id",t.message_id),i(S),h(S)},d={1:"Qu km",2:"Km",3:"Trung bnh",4:"t",5:"Rt tt"},m=t&&t.react&&((j=t==null?void 0:t.react)==null?void 0:j.rate)!=0;return r.jsx(r.Fragment,{children:r.jsxs(C,{alignItems:"center",justifyContent:"space-between",spacing:2,py:5,sx:{backgroundColor:"rgba(0,255,255,0.25)",borderRadius:5},children:[r.jsx(F,{variant:"caption",sx:{color:"#000"},children:t.text}),(a<0||c)&&!t.is_favourite&&r.jsx(Mn,{name:"simple-controlled",value:o,max:5,onChange:p,sx:{color:"orange"},disabled:m}),r.jsxs(C,{direction:"row",spacing:2,children:[o!==null&&r.jsx(F,{sx:{mt:1,color:"#333"},children:d[o]}),e&&r.jsx(je,{el:t,onDelete:()=>s(t)})]})]})})},je=({el:t,onDelete:e})=>{if(!t)return null;const s=t.role<0,[n,o]=u.useState(null),i=!!n,a=p=>{o(p.currentTarget)},c=()=>{o(null)},h=()=>{c(),e&&e(t)};return r.jsxs(r.Fragment,{children:[r.jsx(Uo,{id:"basic-button",onClick:a,fontSize:"small"}),r.jsx(Xs,{id:"basic-menu",anchorEl:n,open:i,onClose:c,MenuListProps:{"aria-labelledby":"basic-button"},children:r.jsx(C,{spacing:1,px:1,children:s&&r.jsx(r.Fragment,{children:r.jsxs(Qs,{onClick:h,children:[r.jsx(Gs,{children:r.jsx(Js,{fontSize:"small"})}),"Delete"]})})})})]})},Ts=t=>{let e="msg";if(t!==""){e="doc";const s=t.toLowerCase();t.startsWith("http")||t.startsWith("www")?e="link":[".jpg",".jpeg",".png",".gif",".webp",".jfif"].some(n=>s.includes(n))&&(e="img")}return e},Qo=({menu:t,messages:e,onDelete:s})=>{ue();const n=u.useRef(null);return u.useEffect(()=>{n.current&&setTimeout(()=>{const o=n.current;o.parentElement.scrollTop=o.parentElement.scrollHeight},200)},[e]),r.jsx(W,{p:3,ref:n,children:r.jsx(C,{spacing:1,children:e&&e.map(o=>{switch(o.file_url&&o.file_url!==""?Ts(o.file_url):o.type){case"timeline":return r.jsx(Xo,{el:o,menu:t,onDelete:s},`TimeLineMsg-${o.message_id}`);case"img":return r.jsx(Yo,{el:o,menu:t,onDelete:s},`MediaMsg-${o.message_id}`);case"doc":return r.jsx(Ho,{el:o,menu:t,onDelete:s},`DocMsg-${o.message_id}`);case"link":return r.jsx(qo,{el:o,menu:t,onDelete:s},`LinkMsg-${o.message_id}`);case"reply":return r.jsx(Wo,{el:o,menu:t,onDelete:s},`ReplyMsg-${o.message_id}`);default:return r.jsx(Ko,{el:o,menu:t,onDelete:s},`DefaultMsg-${o.message_id}`)}})})})},Go=te(an)(({theme:t})=>({"& .MuiInputBase-input":{paddingTop:"12px",paddingBottom:"12px"}})),Jo=[{color:"#ddd",icon:r.jsx(Io,{fontSize:"large"}),y:50,title:"Image"}];function Zo(t,e=2){if(t===0)return"0 Bytes";const s=1024,n=e<0?0:e,o=["Bytes","KB","MB","GB","TB"],i=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,i)).toFixed(n))+" "+o[i]}const er=u.forwardRef(({inputValue:t,setInputValue:e,setOpenPicker:s,handleSendMessage:n},o)=>{const[i,a]=u.useState(!1),{userId:c,userRoleId:h,isMobile:p}=he(),{workspaceEl:d}=ht(),m=async()=>{a(l=>!l);try{const l=document.createElement("input");l.type="file",l.onchange=async j=>{const _=j.target;if(!_.files)return;const S=_.files[0];if(!S)return;if(S.size/(1024*1024)>100){mt.error({message:"Kch thc file vt qu 100MB, vui lng chn file nh hn."});return}const b=new FormData;b.append("file",S),b.append("groupId",(d==null?void 0:d.id.toString())||""),b.append("role",h.toString()),b.append("userId",(c==null?void 0:c.toString())||"");for(const[P,Y]of b.entries())console.log(`${P}: ${Y}`);console.log("Upload"),console.log(Array.from(b.entries()));const E=await fetch(`${ts()}/message/upload`,{method:"POST",body:b});if(!E.ok){const P=await E.text();throw new Error(`File upload failed: ${E.status} ${E.statusText} - ${P}`)}const A=`${(await E.json()).filename}`;n(`${new Date(Date.now()).toLocaleString()}-${Zo(S.size)}`,A),console.log("Document message sent successfully")},l.click()}catch(l){l instanceof Error?(console.error(l.message),mt.error({message:"Upload document failed",description:l.message})):(console.error("Unknown error",l),mt.error({message:"Upload document failed"}))}};return r.jsx(Go,{value:t,onChange:l=>e(l.target.value),fullWidth:!0,placeholder:"Write a message...",variant:"filled",onKeyDown:l=>{l.key==="Enter"&&(l.preventDefault(),n(t,""))},InputProps:{disableUnderline:!0,startAdornment:r.jsxs(C,{sx:{width:"max-content",mt:-2},children:[r.jsxs(C,{sx:{position:"relative",display:i?"inline-block":"none"},children:[Jo.map((l,j)=>r.jsx(qt,{placement:"right",title:l.title,children:r.jsx(zt,{sx:{position:"absolute",top:-l.y,backgroundColor:l.color},children:l.icon})},`ActionItem-${j}`)),r.jsx(qt,{placement:"right",title:"Document",children:r.jsx(zt,{onClick:()=>m(),sx:{position:"absolute",top:-120,backgroundColor:"#0159b2"},children:r.jsx(Do,{fontSize:"large"})})})]}),r.jsx(Dt,{position:"start",children:r.jsx(ze,{onClick:()=>a(l=>!l),children:r.jsx(Fo,{})})})]}),endAdornment:r.jsx(Dt,{position:"end",children:r.jsx(ze,{onClick:()=>s(l=>!l),children:r.jsx($o,{})})})}})}),tr=u.forwardRef(({setMessages:t},e)=>{const{userId:s,username:n,userRoleId:o,isMobile:i,generateDatetimeId:a}=he(),[c,h]=u.useState(!1),[p,d]=u.useState(""),m=o===-2,{workspaceEl:l}=ht();u.useEffect(()=>(v.connect(),console.log("WebSocket URL:",v.io.engine.transport.uri),v.on("connect",()=>{console.log("Connected to server",v.id),v.emit("join",{workspace_id:l==null?void 0:l.id})}),v.on("admake/chat/message",y=>{console.log("Received message:",y)}),v.on("disconnect",()=>{console.log("Disconnected from server")}),v.on("admake/chat/message_ack",y=>{t(b=>b.map(E=>E.message_id===y.message_id?{...E,status:"success",message_id:y.message_id}:E))}),()=>{v.off("connect"),v.off("admake/chat/message"),v.off("disconnect"),v.disconnect()}),[l==null?void 0:l.id]);function j(){const y=JSON.parse(localStorage.getItem("Admake-User-Access")||"{}");return(y==null?void 0:y.username)||""}const _=(y,b="")=>{if(!(!y||y==="")){if(v.connected){const E=Date.now(),T={workspace_id:(l==null?void 0:l.id)||"",react:{rate:0},preview:"",reply:"",role:o,icon:"",type:Ts(b),incoming:!1,user_id:s,username:j(),text:y,file_url:b,link:"",message_id:`msg-${a()}`,is_favourite:!1,createdAt:new Date(E),updatedAt:new Date(E),deletedAt:null,status:"sending"};console.log("Send message",T),t(A=>[...A,T]),v.emit("admake/chat/message",T)}else console.warn("Socket.IO not connected.");d("")}},S=()=>{if(v.connected){const y=Date.now(),b={workspace_id:l==null?void 0:l.id,react:{rate:0},preview:"",reply:"",role:o,icon:"",type:"timeline",incoming:!1,user_id:s,username:j(),text:"Qu khch vui lng nh gi d n ny?",file_url:"",link:"",message_id:`tl-${a()}`,is_favourite:!1,createdAt:new Date(y),updatedAt:new Date(y),deletedAt:null,status:"sending"};console.log("Send REWARD message",v.io.opts.host,b),t(E=>[...E,b]),v.emit("admake/chat/message",b)}else console.warn("Socket.IO not connected.");d("")};return r.jsx(r.Fragment,{children:r.jsxs(C,{direction:"row",alignItems:"center",spacing:.5,p:.5,sx:{backgroundColor:"#00B4B6",minWidth:320,zIndex:1300},children:[r.jsx(er,{onEnterKey:()=>_(p),ref:e,inputValue:p,setInputValue:d,setOpenPicker:h,handleSendMessage:_}),r.jsx(W,{sx:{height:48,width:48,backgroundColor:"#ccc",borderRadius:1.5},onClick:()=>_(p),children:r.jsx(C,{sx:{height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},children:r.jsx(ze,{children:r.jsx(rn,{})})})}),m&&r.jsx(W,{sx:{height:48,width:48,backgroundColor:"#ccc",borderRadius:1.5},onClick:()=>S(),children:r.jsx(C,{sx:{height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},children:r.jsx(ze,{children:r.jsx(Vo,{sx:{color:"orange"}})})})})]})})}),sr=({title:t,status:e,messages:s,setMessages:n,onDelete:o})=>{u.useRef(null);const{userRoleId:i,isMobile:a,chatBoxHeight:c,isFullChatUI:h}=he();return u.useEffect(()=>{if(console.log("Start_Socket",v),!v)return;const p=d=>{n(m=>m.filter(l=>l.message_id!==d.message_id))};return v.on("admake/chat/delete",p),()=>{v.off("admake/chat/delete",p)}},[v,n]),r.jsxs(C,{sx:{width:i===-2?a?"":"50vw":"100vw"},children:[r.jsx(Zs,{title:t,status:e}),r.jsx(W,{className:"scrollbar",sx:{overflowY:"scroll",minWidth:320,minHeight:c-105,maxHeight:c-105,backgroundImage:"url(/backGround.png)"},children:r.jsx(Qo,{messages:s,menu:h,onDelete:o})}),r.jsx(tr,{setMessages:n})]})},Rs=tn.forwardRef(function(e,s){return r.jsx(bn,{direction:"up",ref:s,...e})}),nr=({open:t,handleClose:e})=>r.jsxs(os,{open:t,TransitionComponent:Rs,keepMounted:!0,onClose:e,"aria-describedby":"alert-dialog-slide-description",children:[r.jsx(cs,{children:"Block this contact"}),r.jsx(rs,{children:r.jsx(as,{id:"alert-dialog-slide-description",children:"Are you sure you want to block this contact?"})}),r.jsxs(is,{children:[r.jsx(rt,{onClick:e,children:"Cancel"}),r.jsx(rt,{onClick:e,children:"Yes"})]})]}),or=({open:t,handleClose:e})=>r.jsxs(os,{open:t,TransitionComponent:Rs,keepMounted:!0,onClose:e,"aria-describedby":"alert-dialog-slide-description",children:[r.jsx(cs,{children:"Delete this chat"}),r.jsx(rs,{children:r.jsx(as,{id:"alert-dialog-slide-description",children:"Are you sure you want to delete this chat?"})}),r.jsxs(is,{children:[r.jsx(rt,{onClick:e,children:"Cancel"}),r.jsx(rt,{onClick:e,children:"Yes"})]})]}),rr=({messages:t})=>{const{workspaceEl:e}=ht(),[s,n]=u.useState(!1),[o,i]=u.useState(!1),[a,c]=u.useState([]),{isMobile:h,chatBoxHeight:p}=he();u.useEffect(()=>{t&&t.length>0&&c(t.filter(T=>T.type==="img"||T.type==="doc"))},[t,e]);const d=()=>{n(!1)},m=()=>{i(!1)},[l,j]=u.useState(0),_=(T,A)=>{j(A)},[S,y]=u.useState(null),b=T=>{y(T),window.open(`${wt()}/${T}`,"_blank")},E={fontSize:12,minWidth:120};return r.jsxs(W,{sx:{width:h?"80vw":"30vw",p:1,minHeight:p,maxHeight:p,boxSizing:"border-box"},children:[r.jsxs(C,{className:"scrollbar",sx:{position:"relative",flexGrow:1},p:1,spacing:3,children:[r.jsxs(hn,{value:l,onChange:_,"aria-label":"nav tabs",children:[r.jsx($t,{iconPosition:"start",label:"QR",id:"tab-0","aria-controls":"tabpanel-0",sx:E}),r.jsx($t,{iconPosition:"start",label:"Ti liu",id:"tab-0","aria-controls":"tabpanel-0",sx:E})]}),l===0&&r.jsxs(C,{direction:"column",spacing:0,sx:{width:"100%",overflowY:"auto",overflowX:"hidden"},children:[r.jsx(Ft,{title:"M QR cho khch hng",filename:"qrcode-admake-khachhang.png",url:`${window.location.origin}/chat/${e==null?void 0:e.id}`}),r.jsx(Ft,{title:"M QR cho nhn vin",filename:"qrcode-admake-nhanvien.png",url:`${window.location.origin}/chat/a${e==null?void 0:e.id}`})]}),l===1&&r.jsx(W,{sx:{p:.5,width:"100%",overflowY:"scroll"},children:a.length>0?a.map((T,A)=>r.jsx("img",{src:`${wt()}/${T.file_url}`,alt:T.file_url.split("_")[0],style:{width:"100%",height:"auto",marginBottom:8,cursor:"pointer"},onClick:()=>b(T.file_url)},A)):r.jsx(F,{variant:"body1",children:"Cha c ti liu"})}),r.jsx(en,{})]}),s&&r.jsx(nr,{open:s,handleClose:d}),o&&r.jsx(or,{open:o,handleClose:m})]})},dr=()=>{const{workspaceEl:t,setWorkspaceEl:e}=ht(),[s,n]=u.useState(!1),[o,i]=u.useState([]),[a,c]=u.useState(""),[h,p]=u.useState(""),[d,m]=u.useState(!1),[l,j]=u.useState(null),_=ts(),{userRoleId:S,workspaces:y,isMobile:b,isFullChatUI:E,chatBoxHeight:T}=he();u.useEffect(()=>{t!=null&&P(t)},[t]);const A=x=>{i(R=>R.filter(I=>I.message_id!==x.message_id)),v.emit("admake/chat/delete",{message_id:x.message_id,workspace_id:x.workspace_id})},P=x=>{e&&e(x),m(!0),fetch(`${_}/group/${x.id}/messages`).then(R=>R.json()).then(R=>{R&&R.messages&&(console.log("Data_Message",R.messages),i(R.messages),c(x.name),p(x.status),e(x)),m(!1)}).catch(R=>{console.error("Error khi ly d liu:",R),j(R),m(!1)}),n(!1)};u.useEffect(()=>{if(t)return v.on("admake/chat/message_deleted",({message_id:x})=>{i(R=>R.filter(I=>I.message_id!==x))}),v.emit("admake/chat/join_group",{workspace_id:t.id}),v.on("admake/chat/message",x=>{x.workspace_id===t.id&&i(R=>[...R,x])}),()=>{v.off("admake/chat/message"),v.off("admake/chat/message_deleted"),v.emit("admake/chat/leave_group",{group_id:t.id})}},[t]);const Y=ue();return r.jsx(r.Fragment,{children:r.jsxs(C,{direction:b?"column":"row",style:{minHeight:"82vh"},children:[E&&r.jsx(W,{sx:{backgroundColor:Y.palette.mode==="light"?"#F8FAFF":"#fff",minWidth:"20vw",display:{xs:s?"block":"none",sm:"block"},boxShadow:"0px 0px 2px rgba(0,0,0,0.25)"},children:r.jsx(C,{spacing:.5,className:"scrollbar",sx:{flexGrow:1,height:T,overflowY:"hidden"},children:y&&y.map((x,R)=>r.jsx(Vn,{workspace:x,onClick:()=>P(x),selected:(t==null?void 0:t.id)===x.id},`ChatElement-${R}`))})}),r.jsx(sr,{setMessages:i,messages:o,title:a,status:h||null,onDelete:A}),E&&r.jsx(rr,{messages:o})]})})};export{pr as C,dr as G,ht as u};
