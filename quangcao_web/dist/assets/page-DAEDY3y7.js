import{r as a,Z as b,q as P,s,v as U}from"./index-BXXYp2-3.js";import{T as B,c as E}from"./data-DDNX2YHv.js";import{S as L}from"./SalaryBoard-BiDhenhr.js";import{U as $}from"./dashboard-BWCA0JwZ.js";import{d as l}from"./JobAsset-wAgX0RNC.js";import{l as D,C as W}from"./index-ChesJfE3.js";import{T as _,S as f}from"./TitlePanel-Bzo8afL4.js";import"./index-As2cpPFn.js";import"./QRCode-CxAOjc5F.js";import"./Tabs-CvT0LK4S.js";import"./TableRow-BDzP2Zfv.js";import"./auth.service-Bkqo34eK.js";import"./Send-1mQQ7cfY.js";const{Option:q}=f,et=()=>{const[n,i]=a.useState({page:1,limit:10,search:"",month:l().format("YYYY-MM")}),{setTaskDetail:S}=b(),[x,w]=a.useState([]),[j,c]=a.useState(!1),[y,Y]=a.useState(0),[m,p]=a.useState(!1),[C,h]=a.useState(null),{userLeadId:M,canViewPermission:r}=P(),k=(()=>{const t=[],e=l();let o=l("2025-11-01");for(;o.isBefore(e)||o.isSame(e,"month");)t.unshift({value:o.format("YYYY-MM"),label:o.format("MM/YYYY")}),o=o.add(1,"month");return t})(),T=t=>{h(t),p(!0)},v=()=>{p(!1),h(null)},O=t=>{i(e=>({...e,...t,page:1}))},R=async({page:t,limit:e,search:d,month:o})=>{c(!0);try{const g=await(await fetch(`${U()}/workpoint/page?`+new URLSearchParams({lead:M.toString(),page:String(t),limit:String(e),search:d,month:o}))).json();w(g.data),Y(g.pagination.total)}catch(u){console.error("Failed to fetch workpoints",u)}finally{c(!1)}};return a.useEffect(()=>{R(n)},[n]),a.useEffect(()=>{console.log("canViewPermission",r),S(null)},[]),r!=null&&r.view_workpoint?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"min-h-screen p-2 w-full",children:[s.jsx(D,{gutter:16,style:{marginBottom:16},children:s.jsxs(W,{span:6,children:[s.jsx(_.Text,{strong:!0,children:"Chọn tháng:"}),s.jsx(f,{value:n.month,onChange:t=>O({month:t}),style:{width:"100%"},placeholder:"Chọn tháng",children:k.map(t=>s.jsx(q,{value:t.value,children:t.label},t.value))})]})}),s.jsx(B,{columns:E(T),dataSource:x,loading:j,pagination:{pageSize:n.limit,current:n.page,total:y,onChange:(t,e)=>{i({...n,page:t,limit:e})},showSizeChanger:!0,showTotal:(t,e)=>`${e[0]}-${e[1]} của ${t} nhân sự`,style:{paddingRight:"15px"},locale:{items_per_page:"/ Trang"}}})]}),m&&s.jsx(L,{selectedRecord:C,modalVisible:m,handleOk:v,month:n.month})]}):s.jsx($,{})};export{et as default};
