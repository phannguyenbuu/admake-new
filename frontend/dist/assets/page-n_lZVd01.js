import{r as n,Z as R,q as U,s as o,v as B}from"./index-BpUPXcL_.js";import{T as E,c as L}from"./data-DYZpf2IN.js";import{S as P}from"./SalaryBoard-CIU5u2WY.js";import{U as $}from"./dashboard-CnTXUokc.js";import{d as i}from"./dayjs.min-C6See26L.js";import{T as D,S as f}from"./Add-DpSBps33.js";import"./index-BAkxpmyU.js";import"./index-CzJWAm6W.js";import"./CaretUpOutlined-ByFJ9-Rr.js";import"./QRCode-DuTOs_t_.js";import"./TitlePanel-DNSmZtm7.js";import"./JobAsset-DWFnkQBE.js";import"./Button-BNeyAR28.js";import"./Send-Drl3n17p.js";import"./index-Wy-PPjEe.js";import"./Tabs-BfWhfSd6.js";import"./TableRow-ymIC7gPw.js";import"./UserOutlined-CMyp42RR.js";const{Option:I}=f,at=()=>{const[s,l]=n.useState({page:1,limit:10,search:"",month:i().format("YYYY-MM")}),{setTaskDetail:S}=R(),[x,w]=n.useState([]),[y,c]=n.useState(!1),[j,Y]=n.useState(0),[m,p]=n.useState(!1),[M,h]=n.useState(null),{userLeadId:k,canViewPermission:r}=U(),v=(()=>{const t=[],e=i();let a=i("2025-11-01");for(;a.isBefore(e)||a.isSame(e,"month");)t.unshift({value:a.format("YYYY-MM"),label:a.format("MM/YYYY")}),a=a.add(1,"month");return t})(),T=t=>{h(t),p(!0)},C=()=>{p(!1),h(null)},O=t=>{l(e=>({...e,...t,page:1}))},b=async({page:t,limit:e,search:d,month:a})=>{c(!0);try{const g=await(await fetch(`${B()}/workpoint/page?`+new URLSearchParams({lead:k.toString(),page:String(t),limit:String(e),search:d,month:a}))).json();w(g.data),Y(g.pagination.total)}catch(u){console.error("Failed to fetch workpoints",u)}finally{c(!1)}};return n.useEffect(()=>{b(s)},[s]),n.useEffect(()=>{S(null)},[]),r!=null&&r.view_workpoint?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"min-h-screen p-2 w-full",children:[o.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[o.jsx(D.Text,{strong:!0,style:{whiteSpace:"nowrap"},children:"Chọn tháng:"}),o.jsx(f,{value:s.month,onChange:t=>O({month:t}),style:{width:"50vw"},placeholder:"Chọn tháng",children:v.map(t=>o.jsx(I,{value:t.value,children:t.label},t.value))})]}),o.jsx(E,{columns:L(T,s.month),dataSource:x,loading:y,pagination:{pageSize:s.limit,current:s.page,total:j,onChange:(t,e)=>{l({...s,page:t,limit:e})},showSizeChanger:!0,showTotal:(t,e)=>`${e[0]}-${e[1]} của ${t} nhân sự`,style:{paddingRight:"15px"},locale:{items_per_page:"/ Trang"}}})]}),m&&o.jsx(P,{selectedRecord:M,modalVisible:m,handleOk:C,month:s.month})]}):o.jsx($,{})};export{at as default};
