import{r as n,Z as b,q as P,s as o,v as U}from"./index-DBnuHJB3.js";import{T as B,c as E}from"./data-DbuQd-ee.js";import{S as L}from"./SalaryBoard-icQyR0p1.js";import{U as $}from"./dashboard-CHI9-Uq4.js";import{d as i}from"./JobAsset-87unebk6.js";import{l as D,C as W}from"./index-DteIILW0.js";import{T as _,S as f}from"./Add-DkLpEJzH.js";import"./index-CoeGip6p.js";import"./CaretUpOutlined-yqYTFkOj.js";import"./QRCode-BCYdlrgo.js";import"./TitlePanel-DO8YxNLB.js";import"./Tabs-CGh3m69S.js";import"./TableRow-BnNiFHkB.js";import"./auth.service-BbXC0kJ-.js";import"./Button-hqA-vaAN.js";import"./Send-Co2g7Bnc.js";import"./index-BX7zZX17.js";const{Option:q}=f,nt=()=>{const[s,l]=n.useState({page:1,limit:10,search:"",month:i().format("YYYY-MM")}),{setTaskDetail:S}=b(),[x,w]=n.useState([]),[j,c]=n.useState(!1),[y,Y]=n.useState(0),[m,p]=n.useState(!1),[C,h]=n.useState(null),{userLeadId:M,canViewPermission:r}=P(),k=(()=>{const t=[],e=i();let a=i("2025-11-01");for(;a.isBefore(e)||a.isSame(e,"month");)t.unshift({value:a.format("YYYY-MM"),label:a.format("MM/YYYY")}),a=a.add(1,"month");return t})(),T=t=>{h(t),p(!0)},v=()=>{p(!1),h(null)},O=t=>{l(e=>({...e,...t,page:1}))},R=async({page:t,limit:e,search:d,month:a})=>{c(!0);try{const g=await(await fetch(`${U()}/workpoint/page?`+new URLSearchParams({lead:M.toString(),page:String(t),limit:String(e),search:d,month:a}))).json();w(g.data),Y(g.pagination.total)}catch(u){console.error("Failed to fetch workpoints",u)}finally{c(!1)}};return n.useEffect(()=>{R(s)},[s]),n.useEffect(()=>{console.log("canViewPermission",r),S(null)},[]),r!=null&&r.view_workpoint?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"min-h-screen p-2 w-full",children:[o.jsx(D,{gutter:16,style:{marginBottom:16},children:o.jsxs(W,{span:6,children:[o.jsx(_.Text,{strong:!0,children:"Chọn tháng:"}),o.jsx(f,{value:s.month,onChange:t=>O({month:t}),style:{width:"100%"},placeholder:"Chọn tháng",children:k.map(t=>o.jsx(q,{value:t.value,children:t.label},t.value))})]})}),o.jsx(B,{columns:E(T,s.month),dataSource:x,loading:j,pagination:{pageSize:s.limit,current:s.page,total:y,onChange:(t,e)=>{l({...s,page:t,limit:e})},showSizeChanger:!0,showTotal:(t,e)=>`${e[0]}-${e[1]} của ${t} nhân sự`,style:{paddingRight:"15px"},locale:{items_per_page:"/ Trang"}}})]}),m&&o.jsx(L,{selectedRecord:C,modalVisible:m,handleOk:v,month:s.month})]}):o.jsx($,{})};export{nt as default};
